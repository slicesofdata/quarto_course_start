<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Gabriel I. Cook">
<meta name="dcterms.date" content="2023-12-17">

<title>PSYC166 - Data subsets and summaries</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://kit.fontawesome.com/78ddb093ea.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../css/nav.css">
<link rel="stylesheet" href="../css/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title"><strong>PSYC166</strong></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text"><strong>Home</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus/syllabus.html" rel="" target="" aria-current="page">
 <span class="menu-text"><strong>Syllabus</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../modules/index.html" rel="" target="">
 <span class="menu-text"><strong>Modules</strong></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project/index.html" rel="" target="">
 <span class="menu-text"><strong>Project</strong></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-slides" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Slides</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-slides">    
        <li>
    <a class="dropdown-item" href="../slides/_sample_quarto_presentation.qmd" rel="" target="">
 <span class="dropdown-text">Topic 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-homework" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Homework</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-homework">    
        <li>
    <a class="dropdown-item" href="../homework/HW01.Rmd" rel="" target="">
 <span class="dropdown-text">HW 1</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-data" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Data</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-data">    
        <li>
    <a class="dropdown-item" href="https://github.com/slicesofdata/dataviz23/raw/main/data/cms-top-all-time-2023-swim.zip" rel="" target="">
 <span class="dropdown-text">cms-top-all-time-2023-swim.xlsx</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/rfordatascience/tidytuesday" rel="" target="">
 <span class="dropdown-text">Fun Tidy Tuesday Data Sets</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cheatsheets" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text"><strong>Cheatsheets</strong></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cheatsheets">    
        <li>
    <a class="dropdown-item" href="../cheatsheets/rmarkdown-2.0.pdf" rel="" target="">
 <span class="dropdown-text">RMarkdown</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" rel="" target="">
 <span class="dropdown-text">Data Wrangling with {dplyr} and {tidyr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/quarto.html" rel="" target="">
 <span class="dropdown-text">Quarto (Publish and Share)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/strings.html" rel="" target="">
 <span class="dropdown-text">String Manipulation with {stringr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/html/data-import.html" rel="" target="">
 <span class="dropdown-text">Reading and Writing Data with {readr}</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cheatsheets/Data_Science_With_R_Workflow.pdf" rel="" target="">
 <span class="dropdown-text">Data Science with RWorkflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://rstudio.github.io/cheatsheets/" rel="" target="">
 <span class="dropdown-text">More Cheatsheets Here</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://images.datacamp.com/image/upload/v1676540721/Marketing/Blog/Quarto_Cheat_Sheet.pdf" rel="" target="">
 <span class="dropdown-text">Quarto Cheat Sheet (what Quarto Files Look Like)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../resources/tools.html" rel="" target="">
 <span class="menu-text"><strong>Other Tools</strong></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/slicesofdata/fods24" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modules/index.html">Modules</a></li><li class="breadcrumb-item"><a href="../modules/07_data_subsets_and_summaries.html"><strong>Data subsets and summaries</strong></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus/syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Syllabus</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modules/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/001_installing_and_setting_up_git_and_github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Installing and Setting Up Git and GitHub for R</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/01_installing_r_and_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Installing R &amp; RStudio</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/04_data_frame_manipulation_and_wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Data frame manipulation and wrangling</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/07_data_subsets_and_summaries.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><strong>Data subsets and summaries</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modules/99_importing_many_files_into_a_single_data_frame.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Importing many delimited files into a single data frame</strong></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../project/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/02_project_team_roles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Team membership and roles</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/04_project_midterm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Midterm presentation</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/08_project_final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Final presentation</strong></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project/10_project_report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Final report</strong></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><strong>Overview</strong></a></li>
  <li><a href="#to-do" id="toc-to-do" class="nav-link" data-scroll-target="#to-do"><strong>To Do</strong></a>
  <ul class="collapse">
  <li><a href="#readings" id="toc-readings" class="nav-link" data-scroll-target="#readings"><strong>Readings</strong></a></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><strong>Task</strong></a></li>
  <li><a href="#libraries" id="toc-libraries" class="nav-link" data-scroll-target="#libraries"><strong>Libraries</strong></a></li>
  <li><a href="#external-functions" id="toc-external-functions" class="nav-link" data-scroll-target="#external-functions"><strong>External Functions</strong></a></li>
  <li><a href="#libraries-1" id="toc-libraries-1" class="nav-link" data-scroll-target="#libraries-1"><strong>Libraries</strong></a></li>
  </ul></li>
  <li><a href="#loading-and-looking-at-data" id="toc-loading-and-looking-at-data" class="nav-link" data-scroll-target="#loading-and-looking-at-data"><strong>Loading and Looking at Data</strong></a></li>
  <li><a href="#modifying-a-data-frame-or-tibble-using-dplyr" id="toc-modifying-a-data-frame-or-tibble-using-dplyr" class="nav-link" data-scroll-target="#modifying-a-data-frame-or-tibble-using-dplyr"><strong>Modifying a Data Frame or Tibble Using {dplyr}</strong></a>
  <ul class="collapse">
  <li><a href="#creating-a-new-variable" id="toc-creating-a-new-variable" class="nav-link" data-scroll-target="#creating-a-new-variable"><strong>Creating a new variable</strong></a></li>
  <li><a href="#modifying-a-new-variable" id="toc-modifying-a-new-variable" class="nav-link" data-scroll-target="#modifying-a-new-variable"><strong>Modifying a new variable</strong></a>
  <ul class="collapse">
  <li><a href="#set-an-existing-variable-equal-to-a-constant" id="toc-set-an-existing-variable-equal-to-a-constant" class="nav-link" data-scroll-target="#set-an-existing-variable-equal-to-a-constant"><em>Set an existing variable equal to a constant</em></a></li>
  <li><a href="#set-an-existing-variable-equal-to-another-value" id="toc-set-an-existing-variable-equal-to-another-value" class="nav-link" data-scroll-target="#set-an-existing-variable-equal-to-another-value"><em>Set an existing variable equal to another value</em></a></li>
  <li><a href="#converting-variables-that-are-time-related-using-lubridate" id="toc-converting-variables-that-are-time-related-using-lubridate" class="nav-link" data-scroll-target="#converting-variables-that-are-time-related-using-lubridate"><strong>Converting variables that are time related using {lubridate}</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#quick-summary-using-base-r" id="toc-quick-summary-using-base-r" class="nav-link" data-scroll-target="#quick-summary-using-base-r"><strong>Quick Summary Using <code>base R</code></strong></a></li>
  <li><a href="#summarizing-data-using-dplyr" id="toc-summarizing-data-using-dplyr" class="nav-link" data-scroll-target="#summarizing-data-using-dplyr"><strong>Summarizing Data Using {dplyr}</strong></a></li>
  <li><a href="#summarizing-across-multiple-variables" id="toc-summarizing-across-multiple-variables" class="nav-link" data-scroll-target="#summarizing-across-multiple-variables"><strong>Summarizing <code>across()</code> Multiple Variables</strong></a>
  <ul class="collapse">
  <li><a href="#summarize-across-by-numeric-variables" id="toc-summarize-across-by-numeric-variables" class="nav-link" data-scroll-target="#summarize-across-by-numeric-variables"><em>Summarize across by numeric variables:</em></a></li>
  <li><a href="#passing-multiple-functions-from-a-list-in-across" id="toc-passing-multiple-functions-from-a-list-in-across" class="nav-link" data-scroll-target="#passing-multiple-functions-from-a-list-in-across"><em>Passing multiple functions from a <code>list()</code> in <code>across()</code></em></a>
  <ul class="collapse">
  <li><a href="#fixing-.names-when-passing-lists-to-.cols-in-across" id="toc-fixing-.names-when-passing-lists-to-.cols-in-across" class="nav-link" data-scroll-target="#fixing-.names-when-passing-lists-to-.cols-in-across"><em>Fixing <code>.names</code> when passing lists to <code>.cols</code> in <code>across()</code></em></a></li>
  </ul></li>
  <li><a href="#summarize-by-groups-using-group_by" id="toc-summarize-by-groups-using-group_by" class="nav-link" data-scroll-target="#summarize-by-groups-using-group_by"><strong>Summarize by Groups Using <code>group_by()</code></strong></a>
  <ul class="collapse">
  <li><a href="#identifying-how-to-group" id="toc-identifying-how-to-group" class="nav-link" data-scroll-target="#identifying-how-to-group"><em>Identifying how to group</em></a></li>
  </ul></li>
  <li><a href="#summarize-a-one-specific-variable-by-groups-using-group_by" id="toc-summarize-a-one-specific-variable-by-groups-using-group_by" class="nav-link" data-scroll-target="#summarize-a-one-specific-variable-by-groups-using-group_by"><strong>Summarize A (one) Specific Variable by Groups Using <code>group_by()</code></strong></a>
  <ul class="collapse">
  <li><a href="#a-single-summary-metric" id="toc-a-single-summary-metric" class="nav-link" data-scroll-target="#a-single-summary-metric"><em>A single summary metric</em></a></li>
  <li><a href="#multiple-summary-metrics" id="toc-multiple-summary-metrics" class="nav-link" data-scroll-target="#multiple-summary-metrics"><em>Multiple summary metrics</em></a></li>
  </ul></li>
  <li><a href="#summarizing-multiple-variables-by-groups-using-group_by" id="toc-summarizing-multiple-variables-by-groups-using-group_by" class="nav-link" data-scroll-target="#summarizing-multiple-variables-by-groups-using-group_by"><strong>Summarizing Multiple Variables by Groups Using <code>group_by()</code></strong></a>
  <ul class="collapse">
  <li><a href="#a-single-summary-metric-1" id="toc-a-single-summary-metric-1" class="nav-link" data-scroll-target="#a-single-summary-metric-1"><em>A single summary metric</em></a></li>
  <li><a href="#multiple-summary-metrics-1" id="toc-multiple-summary-metrics-1" class="nav-link" data-scroll-target="#multiple-summary-metrics-1"><em>Multiple summary metrics</em></a></li>
  </ul></li>
  <li><a href="#summarizing-multiple-variables-with-reference-by-name" id="toc-summarizing-multiple-variables-with-reference-by-name" class="nav-link" data-scroll-target="#summarizing-multiple-variables-with-reference-by-name"><strong>Summarizing Multiple Variables With Reference by Name`</strong></a>
  <ul class="collapse">
  <li><a href="#variables-that-are-numeric" id="toc-variables-that-are-numeric" class="nav-link" data-scroll-target="#variables-that-are-numeric"><em>Variables that are numeric</em></a></li>
  <li><a href="#variables-by-pattern-match" id="toc-variables-by-pattern-match" class="nav-link" data-scroll-target="#variables-by-pattern-match"><em>Variables by pattern match</em></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><strong>Summary</strong></a>
  <ul class="collapse">
  <li><a href="#a-functional-approach" id="toc-a-functional-approach" class="nav-link" data-scroll-target="#a-functional-approach"><strong>A Functional Approach</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><strong>Data subsets and summaries</strong></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Gabriel I. Cook </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Under construction.
</div>
</div>
<div class="callout-body-container callout-body">
<p>This page is a work in progress and may contain areas that need more detail or that required syntactical, grammatical, and typographical changes. If you find some part requiring some editing, please let me know so I can fix it for you.</p>
</div>
</div>
<section id="overview" class="level1">
<h1><strong>Overview</strong></h1>
<p>This module demonstrates how to use <strong>{dplyr}</strong> to subset data, mutate variables, and summarize variables in data frames. Many data summaries involve creating group-level statistics so we will also cover grouping across variables. <strong>{lubridate}</strong> will be used to handle time vectors.</p>
</section>
<section id="to-do" class="level1">
<h1><strong>To Do</strong></h1>
<section id="readings" class="level2">
<h2 class="anchored" data-anchor-id="readings"><strong>Readings</strong></h2>
</section>
<section id="task" class="level2">
<h2 class="anchored" data-anchor-id="task"><strong>Task</strong></h2>
</section>
<section id="libraries" class="level2">
<h2 class="anchored" data-anchor-id="libraries"><strong>Libraries</strong></h2>
<ul>
<li><strong>{here}</strong>: 1.0.1: for path management</li>
<li><strong>{dplyr}</strong> 1.1.2: for selecting, filtering, and mutating</li>
<li><strong>{magrittr}</strong> 2.0.3: for code clarity and piping data frame objects</li>
<li><strong>{lubridate}</strong> 1.9.2: for handling date and time vectors</li>
</ul>
</section>
<section id="external-functions" class="level2">
<h2 class="anchored" data-anchor-id="external-functions"><strong>External Functions</strong></h2>
<p>Provided in class:</p>
<p><code>view_html()</code>: for viewing data frames in html format, from <code>/r/my_functions.R</code></p>
<p>You can use this in your own workspace but I am having a challenge rendering this of the website, so I’ll default to <code>print()</code> on occasion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"r"</span>, <span class="st">"my_functions.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="libraries-1" class="level2">
<h2 class="anchored" data-anchor-id="libraries-1"><strong>Libraries</strong></h2>
<p>We will work with a few different libraries for data manipulation. Let’s load them into our work space using <code>library()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
</section>
</section>
<section id="loading-and-looking-at-data" class="level1">
<h1><strong>Loading and Looking at Data</strong></h1>
<p>In order to perform any data summary, you need data. We will use the file name <code>"cms-top-all-time-2023-swim.xlsx"</code> that is located at a URL. We could just access the file from the full URL path but we will later want to same a <em>cleaned</em> version of the file for later use. Modifying the file name will be easier than hard coding the path in both places. Thus, we will use <code>paste()</code> to concatenate the file name and the URL location while also passing the <code>sep = ""</code> argument to make sure there is no space (an empty string) between the two strings. By default, <code>paste()</code> uses <code>sep = " "</code>, which you can see contains a string with a space. We will then pass that concatenated string to <code>openxlsx::read.xlsx()</code> and assign the returned data frame to an object named <code>DAT</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>file_name <span class="ot">&lt;-</span> <span class="st">"cms-top-all-time-2023-swim.xlsx"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://github.com/slicesofdata/dataviz23/raw/main/data/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Look to make sure there are not any odd spacing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(base_url, file_name, <span class="at">sep =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://github.com/slicesofdata/dataviz23/raw/main/data/cms-top-all-time-2023-swim.xlsx"</code></pre>
</div>
</div>
<p>We will pass this string to the <code>xlxsFile</code> argument and also pass <code>sheet = "swim"</code> so the swim worksheet is read from the file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="ot">&lt;-</span> openxlsx<span class="sc">::</span><span class="fu">read.xlsx</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlsxFile =</span> <span class="fu">paste</span>(base_url, file_name, <span class="at">sep =</span> <span class="st">""</span>), </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sheet =</span> <span class="st">"swim"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>View its contents:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DAT) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   time             name year   event   team
1 23.29 Jocelyn Crawford 2019 50 FREE Athena
2 23.31    Ava Sealander 2022 50 FREE Athena
3 23.49        Kelly Ngo 2016 50 FREE Athena
4 23.71        Helen Liu 2014 50 FREE Athena
5 23.76      Michele Kee 2014 50 FREE Athena
6 23.77 Natalia Orbach-M 2020 50 FREE Athena</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#view_html(DAT)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have several variables: time, name, year, event, team. Some appear to be numeric and some are characters. Passing the data frame to <code>dplyr::glimpse()</code> will provide more detail (see also <code>str()</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(DAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 440
Columns: 5
$ time  &lt;chr&gt; "23.29", "23.31", "23.49", "23.71", "23.76", "23.77", "23.77", "…
$ name  &lt;chr&gt; "Jocelyn Crawford", "Ava Sealander", "Kelly Ngo", "Helen Liu", "…
$ year  &lt;chr&gt; "2019", "2022", "2016", "2014", "2014", "2020", "2020", "2010", …
$ event &lt;chr&gt; "50 FREE", "50 FREE", "50 FREE", "50 FREE", "50 FREE", "50 FREE"…
$ team  &lt;chr&gt; "Athena", "Athena", "Athena", "Athena", "Athena", "Athena", "Ath…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or DAT %&gt;% dplyr::glimpse()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hmm, looks like there are <code>&lt;chr&gt;</code> and <code>&lt;dbl&gt;</code> variables and some numbers are in quotes. Objects in quotes are strings. So we need to clean up the file before we can even get a summary. Other than looking at the structure of data frame using <code>glimpse()</code> or <code>str()</code>, you can examine vectors individually.</p>
<p>When vectors are in data frames, you can reference them using the <code>$</code> notation: <code>my_dataframe$my_variable</code>. Passing this to <code>is.numeric()</code> will also tell you whether the vector is numeric by returning either <code>TRUE</code> or <code>FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(DAT<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>OK, so this variable is definitely not numeric. Looking at the file, we need to convert at least one variable that should be numbers from character to numeric.</p>
</section>
<section id="modifying-a-data-frame-or-tibble-using-dplyr" class="level1">
<h1><strong>Modifying a Data Frame or Tibble Using {dplyr}</strong></h1>
<p>Use <code>dplyr::mutate()</code> to create, modify, and delete column variables. At every least, you will need to pass a data frame as the first argument, <code>.data</code> and then a name-value pair as the second argument. There are other arguments that are experimental which will not be the focus of this module.</p>
<pre><code>mutate(
  .data,
  ...,
  .by = NULL,
  .keep = c("all", "used", "unused", "none"),
  .before = NULL,
  .after = NULL
)</code></pre>
<p>We will use <code>mutate()</code> in conjunction with <strong>{magrittr}</strong>’s <code>%&gt;%</code> for code piping.</p>
<section id="creating-a-new-variable" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-new-variable"><strong>Creating a new variable</strong></h2>
<p>We will pass the data frame into <code>mutate()</code> and then specify a name-value variable pair. When using <code>%&gt;%</code>, the data frame piped into the function will be represented as <code>.</code>. This <code>.</code> is not needed but serves as a good reminder that the data frame that is passed into <code>mutate()</code> is from the previous line of code. In order to keep the print out manageable, we will also use the <code>slice()</code> function.</p>
<pre><code>mutate(data_frame, 
    new_variable_name = variable
    )</code></pre>
<p>Create new variables that are set to a constant number or string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(., <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>   <span class="co"># rows 1 through 5</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">newvar1 =</span> <span class="dv">9999</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">newvar2 =</span> <span class="st">"Student"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   time             name year   event   team newvar1 newvar2
1 23.29 Jocelyn Crawford 2019 50 FREE Athena    9999 Student
2 23.31    Ava Sealander 2022 50 FREE Athena    9999 Student
3 23.49        Kelly Ngo 2016 50 FREE Athena    9999 Student
4 23.71        Helen Liu 2014 50 FREE Athena    9999 Student
5 23.76      Michele Kee 2014 50 FREE Athena    9999 Student</code></pre>
</div>
</div>
<p>You can see that each row in the data frame will take on the paired value.</p>
</section>
<section id="modifying-a-new-variable" class="level2">
<h2 class="anchored" data-anchor-id="modifying-a-new-variable"><strong>Modifying a new variable</strong></h2>
<p>New variables are modified using the same name-value pairing approach. When you modify a variable, you are taking an existing variable to setting it to another value.</p>
<section id="set-an-existing-variable-equal-to-a-constant" class="level3">
<h3 class="anchored" data-anchor-id="set-an-existing-variable-equal-to-a-constant"><em>Set an existing variable equal to a constant</em></h3>
<p>Just use an existing variable name (left of <code>=</code> in name-value pair).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(., <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>   <span class="co"># rows 1 through 5</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">time =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">name =</span> <span class="st">"0"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  time name year   event   team
1    1    0 2019 50 FREE Athena
2    1    0 2022 50 FREE Athena
3    1    0 2016 50 FREE Athena
4    1    0 2014 50 FREE Athena
5    1    0 2014 50 FREE Athena</code></pre>
</div>
</div>
<p>OK, that’s not very helpful. We just replaced our existing variables with nothing useful. You can see that name is still a <code>&lt;chr&gt;</code> type.</p>
</section>
<section id="set-an-existing-variable-equal-to-another-value" class="level3">
<h3 class="anchored" data-anchor-id="set-an-existing-variable-equal-to-another-value"><em>Set an existing variable equal to another value</em></h3>
<p>As long as <strong>{dplyr}</strong> can result the character elements of the vector, <code>as.numeric()</code> will convert the character strings to numbers. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"3.2"</span>, <span class="st">"6.99"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.00 3.20 6.99</code></pre>
</div>
</div>
<p>We can illustrate in a data frame by creating character value that will serve as the constant, and use <code>as.numeric()</code> just to illustrate this example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(., <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>   <span class="co"># rows 1 through 5</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">name =</span> <span class="fu">as.numeric</span>(<span class="st">"0"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   time name year   event   team
1 23.29    0 2019 50 FREE Athena
2 23.31    0 2022 50 FREE Athena
3 23.49    0 2016 50 FREE Athena
4 23.71    0 2014 50 FREE Athena
5 23.76    0 2014 50 FREE Athena</code></pre>
</div>
</div>
<p>And now <code>name</code> is a <code>&lt;dbl&gt;</code>, which is a type of numeric. We can see this by selecting columns from the data frame <code>where()</code> the variable <code>is.numeric()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(., <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>   <span class="co"># rows 1 through 5</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">name =</span> <span class="fu">as.numeric</span>(<span class="st">"0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(., <span class="fu">where</span>(<span class="sc">~</span><span class="fu">is.numeric</span>(.)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  name
1    0
2    0
3    0
4    0
5    0</code></pre>
</div>
</div>
<p>But if we try to convert <code>time</code> to numeric this way, you will see that the complex numbers will be converted to <code>NA</code>s, or missing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(DAT<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 23.29 23.31 23.49 23.71 23.76 23.77 23.77 23.87 23.93 24.02 51.05 51.24
 [13] 51.41 51.56 51.56 51.88 52.05 52.05 52.14 52.17    NA    NA    NA    NA
 [25]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 [37]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 [49]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 [61] 55.66 55.67 55.91 56.11 56.74 56.83 57.18 57.36 57.47 57.56    NA    NA
 [73]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 [85]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
 [97]    NA    NA    NA    NA 54.76 54.92 54.93 55.23 55.74 56.04 56.27 56.42
[109] 56.47 56.56    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[121]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA 22.69 22.92
[133] 22.93 22.95 23.27 23.31 23.33 23.38 23.45 23.47 50.65 50.67 50.92 51.19
[145] 51.27 51.28 51.29 51.37 51.45 51.56    NA    NA    NA    NA    NA    NA
[157]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[169]    NA    NA 25.94 26.22 26.28 26.57 26.82 26.90 27.14 27.14 27.16 27.17
[181] 28.33 28.96 29.05 29.06 29.09 29.09 29.24 29.26 29.46 29.55 24.05 24.28
[193] 24.58 24.59 24.65 24.85 25.05 25.08 25.24 25.34 54.65 54.81 54.91 55.11
[205] 55.13 55.25 55.27 55.45 55.62 56.21    NA    NA    NA    NA    NA    NA
[217]    NA    NA    NA    NA 19.98 20.21 20.22 20.36 20.51 20.65 20.69 20.71
[229] 20.79 20.82 44.06 44.21 44.73 44.94 45.24 45.31 45.32 45.45 45.50 45.50
[241]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[253]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[265]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[277]    NA    NA    NA    NA 46.99 47.57 49.32 49.97 50.03 50.29 50.35 50.41
[289] 50.51 50.59    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[301] 54.88 55.80 55.92 56.03 56.27 56.35 56.36 56.45 56.49 56.49    NA    NA
[313]    NA    NA    NA    NA    NA    NA    NA    NA 47.45 47.56 47.80 48.74
[325] 48.91 49.26 49.31 49.34 49.68 49.74    NA    NA    NA    NA    NA    NA
[337]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[349]    NA    NA 19.47 19.63 19.96 20.08 20.10 20.14 20.18 20.22 20.25 20.28
[361] 43.28 43.69 43.74 44.43 44.57 44.59 44.81 44.81 44.83 44.87    NA    NA
[373]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA
[385]    NA    NA    NA    NA    NA    NA 22.32 22.50 22.84 23.00 23.24 23.45
[397] 23.72 23.74 23.85 23.87 24.73 24.81 24.88 25.10 25.20 25.47 25.55 25.63
[409] 26.01 26.05 20.60 21.38 21.48 21.58 21.60 21.81 21.83 22.00 22.06 22.07
[421] 47.01 47.72 48.39 48.50 48.54 48.82 49.00 49.45 49.52 49.60 54.52 55.15
[433] 55.21 55.47 55.62 56.04 56.13 56.19 56.35 56.48</code></pre>
</div>
</div>
<p>The problem we have is that the data are not in a clean form. In this data frame, some elements of <code>time</code> are composed of numbers, decimals, and colons (e.g., x.xx, xx:xx.xx, etc.). which all make up elements that would be numbers.</p>
</section>
<section id="converting-variables-that-are-time-related-using-lubridate" class="level3">
<h3 class="anchored" data-anchor-id="converting-variables-that-are-time-related-using-lubridate"><strong>Converting variables that are time related using {lubridate}</strong></h3>
<p><strong>{lubridate}</strong> is a library for dealing with dates and times. It is also part of the <strong>tidyverse}</strong> ecosystem.</p>
<p>The <code>period_to_seconds()</code> function will convert periods to seconds depending on the period format. We need to pass to it an object that equates to a period of seconds.</p>
<p>For <code>time</code>, the format is: hour minute second (e.g., <code>hms</code>). And there is a <code>hms()</code> function to handle this. Let’s see how it works before modifying the data frame. Load the library if it is not loaded.</p>
<p>We will pass a single character string and convert it to <code>hms</code> with <code>hms()</code> and then convert that to seconds using <code>period_to_seconds()</code>. Because 60 minutes and 1 hour is the same number of seconds, we should end up with the same values. We can also use <code>ms()</code> to convert the format into minutes and seconds and pass to <code>period_to_seconds()</code>. Following the examples, we will apply to the vector in the data frame.</p>
<pre><code>lubridate::period_to_seconds(lubridate::ms())
lubridate::period_to_seconds(lubridate::hms())</code></pre>
<p>Sixty minutes and one hour to <code>hms</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">hms</span>(<span class="st">"00:60:00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "60M 0S"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">hms</span>(<span class="st">"01:00:00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1H 0M 0S"</code></pre>
</div>
</div>
<p>One day to <code>hms</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hms</span>(<span class="st">"24:00:00"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "24H 0M 0S"</code></pre>
</div>
</div>
<p>Sixty minutes and one hour to <code>hms</code> to seconds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">period_to_seconds</span>(lubridate<span class="sc">::</span><span class="fu">hms</span>(<span class="st">"00:60:00"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3600</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lubridate<span class="sc">::</span><span class="fu">period_to_seconds</span>(lubridate<span class="sc">::</span><span class="fu">hms</span>(<span class="st">"01:00:00"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3600</code></pre>
</div>
</div>
<p>OK, good. So let’s see if we can convert <code>time</code>. Because <code>hms()</code> is passed into <code>period_to_seconds()</code>, we first need to verify that <code>hms()</code> can handle it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hms</span>(DAT<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .parse_hms(..., order = "HMS", quiet = quiet): Some strings failed
to parse, or all strings are NAs</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] NA            NA            NA            NA            NA           
  [6] NA            NA            NA            NA            NA           
 [11] NA            NA            NA            NA            NA           
 [16] NA            NA            NA            NA            NA           
 [21] "1H 50M 30S"  "1H 51M 89S"  "1H 52M 40S"  "1H 52M 55S"  "1H 52M 57S" 
 [26] "1H 52M 67S"  "1H 52M 80S"  "1H 52M 83S"  "1H 52M 88S"  "1H 52M 89S" 
 [31] "4H 57M 37S"  "4H 59M 22S"  "4H 59M 78S"  "5H 0M 6S"    "5H 0M 21S"  
 [36] "5H 0M 47S"   "5H 1M 17S"   "5H 1M 99S"   "5H 2M 16S"   "5H 2M 23S"  
 [41] "10H 14M 33S" "10H 15M 40S" "10H 22M 59S" "10H 22M 84S" "10H 24M 14S"
 [46] "10H 24M 82S" "10H 26M 34S" "10H 26M 89S" "10H 33M 15S" "10H 36M 60S"
 [51] "16H 58M 48S" "17H 3M 21S"  "17H 6M 78S"  "17H 9M 9S"   "17H 9M 26S" 
 [56] "17H 12M 18S" "17H 12M 46S" "17H 13M 58S" "17H 21M 98S" "17H 24M 49S"
 [61] NA            NA            NA            NA            NA           
 [66] NA            NA            NA            NA            NA           
 [71] "1H 59M 91S"  "2H 2M 10S"   "2H 3M 73S"   "2H 3M 85S"   "2H 3M 92S"  
 [76] "2H 5M 10S"   "2H 5M 56S"   "2H 5M 71S"   "2H 5M 76S"   "2H 6M 13S"  
 [81] "1H 1M 84S"   "1H 3M 28S"   "1H 3M 51S"   "1H 3M 91S"   "1H 4M 16S"  
 [86] "1H 4M 19S"   "1H 4M 65S"   "1H 4M 66S"   "1H 4M 77S"   "1H 4M 94S"  
 [91] "2H 14M 83S"  "2H 15M 62S"  "2H 18M 99S"  "2H 19M 6S"   "2H 19M 78S" 
 [96] "2H 20M 1S"   "2H 21M 17S"  "2H 21M 77S"  "2H 22M 34S"  "2H 22M 83S" 
[101] NA            NA            NA            NA            NA           
[106] NA            NA            NA            NA            NA           
[111] "2H 1M 84S"   "2H 2M 58S"   "2H 3M 80S"   "2H 4M 5S"    "2H 4M 42S"  
[116] "2H 4M 81S"   "2H 6M 40S"   "2H 7M 12S"   "2H 7M 33S"   "2H 7M 42S"  
[121] "2H 0M 69S"   "2H 3M 59S"   "2H 3M 79S"   "2H 4M 74S"   "2H 5M 41S"  
[126] "2H 6M 82S"   "2H 7M 12S"   "2H 7M 14S"   "2H 7M 81S"   "2H 7M 94S"  
[131] NA            NA            NA            NA            NA           
[136] NA            NA            NA            NA            NA           
[141] NA            NA            NA            NA            NA           
[146] NA            NA            NA            NA            NA           
[151] "1H 50M 91S"  "1H 50M 98S"  "1H 51M 39S"  "1H 51M 41S"  "1H 51M 56S" 
[156] "1H 51M 64S"  "1H 51M 95S"  "1H 52M 53S"  "1H 52M 78S"  "1H 53M 4S"  
[161] "4H 15M 73S"  "4H 27M 18S"  "4H 30M 33S"  "4H 30M 77S"  "4H 31M 96S" 
[166] "4H 32M 45S"  "4H 32M 57S"  "4H 32M 68S"  "4H 34M 16S"  "4H 34M 27S" 
[171] NA            NA            NA            NA            NA           
[176] NA            NA            NA            NA            NA           
[181] NA            NA            NA            NA            NA           
[186] NA            NA            NA            NA            NA           
[191] NA            NA            NA            NA            NA           
[196] NA            NA            NA            NA            NA           
[201] NA            NA            NA            NA            NA           
[206] NA            NA            NA            NA            NA           
[211] "1H 1M 10S"   "1H 2M 88S"   "1H 2M 89S"   "1H 3M 67S"   "1H 4M 10S"  
[216] "1H 4M 16S"   "1H 4M 24S"   "1H 4M 26S"   "1H 4M 35S"   "1H 4M 43S"  
[221] NA            NA            NA            NA            NA           
[226] NA            NA            NA            NA            NA           
[231] NA            NA            NA            NA            NA           
[236] NA            NA            NA            NA            NA           
[241] "1H 38M 35S"  "1H 38M 88S"  "1H 39M 7S"   "1H 39M 35S"  "1H 39M 63S" 
[246] "1H 39M 80S"  "1H 39M 82S"  "1H 40M 30S"  "1H 40M 31S"  "1H 40M 50S" 
[251] "4H 25M 67S"  "4H 28M 11S"  "4H 28M 89S"  "4H 29M 32S"  "4H 31M 64S" 
[256] "4H 32M 52S"  "4H 32M 65S"  "4H 32M 94S"  "4H 32M 98S"  "4H 34M 70S" 
[261] "9H 14M 11S"  "9H 24M 43S"  "9H 35M 78S"  "9H 36M 64S"  "9H 39M 27S" 
[266] "9H 40M 2S"   "9H 41M 48S"  "9H 45M 72S"  "9H 46M 63S"  "9H 47M 9S"  
[271] "15H 17M 24S" "15H 32M 19S" "15H 45M 57S" "15H 47M 40S" "15H 52M 94S"
[276] "15H 53M 75S" "15H 56M 57S" "15H 57M 89S" "16H 2M 45S"  "16H 3M 38S" 
[281] NA            NA            NA            NA            NA           
[286] NA            NA            NA            NA            NA           
[291] "1H 45M 5S"   "1H 45M 67S"  "1H 46M 51S"  "1H 48M 84S"  "1H 49M 1S"  
[296] "1H 49M 38S"  "1H 50M 32S"  "1H 50M 43S"  "1H 51M 7S"   "1H 51M 57S" 
[301] NA            NA            NA            NA            NA           
[306] NA            NA            NA            NA            NA           
[311] "1H 59M 90S"  "2H 1M 18S"   "2H 1M 45S"   "2H 1M 60S"   "2H 1M 66S"  
[316] "2H 1M 77S"   "2H 1M 78S"   "2H 2M 89S"   "2H 3M 19S"   "2H 3M 23S"  
[321] NA            NA            NA            NA            NA           
[326] NA            NA            NA            NA            NA           
[331] "1H 43M 96S"  "1H 48M 70S"  "1H 49M 24S"  "1H 49M 95S"  "1H 49M 96S" 
[336] "1H 50M 34S"  "1H 50M 47S"  "1H 50M 49S"  "1H 50M 51S"  "1H 50M 76S" 
[341] "1H 46M 97S"  "1H 48M 74S"  "1H 49M 74S"  "1H 50M 51S"  "1H 50M 78S" 
[346] "1H 51M 11S"  "1H 51M 24S"  "1H 51M 48S"  "1H 51M 82S"  "1H 51M 83S" 
[351] NA            NA            NA            NA            NA           
[356] NA            NA            NA            NA            NA           
[361] NA            NA            NA            NA            NA           
[366] NA            NA            NA            NA            NA           
[371] "1H 37M 98S"  "1H 38M 49S"  "1H 39M 9S"   "1H 39M 19S"  "1H 39M 66S" 
[376] "1H 40M 21S"  "1H 40M 22S"  "1H 40M 44S"  "1H 40M 70S"  "1H 40M 70S" 
[381] "3H 55M 61S"  "3H 56M 68S"  "3H 56M 88S"  "3H 59M 2S"   "3H 59M 13S" 
[386] "3H 59M 17S"  "4H 0M 63S"   "4H 1M 14S"   "4H 2M 38S"   "4H 2M 99S"  
[391] NA            NA            NA            NA            NA           
[396] NA            NA            NA            NA            NA           
[401] NA            NA            NA            NA            NA           
[406] NA            NA            NA            NA            NA           
[411] NA            NA            NA            NA            NA           
[416] NA            NA            NA            NA            NA           
[421] NA            NA            NA            NA            NA           
[426] NA            NA            NA            NA            NA           
[431] NA            NA            NA            NA            NA           
[436] NA            NA            NA            NA            NA           </code></pre>
</div>
</div>
<p>Yikes! Note the warning and look at the output. Some strings failed and turned to <code>NA</code>. Looking and the <code>time</code> vector again, we see that contains both values like <code>1:52.83</code> and <code>23.87</code>. If there is only one <code>:</code>, we should be able to use <code>ms()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ms</span>(DAT<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "23M 29S"    "23M 31S"    "23M 49S"    "23M 71S"    "23M 76S"   
  [6] "23M 77S"    "23M 77S"    "23M 87S"    "23M 93S"    "24M 2S"    
 [11] "51M 5S"     "51M 24S"    "51M 41S"    "51M 56S"    "51M 56S"   
 [16] "51M 88S"    "52M 5S"     "52M 5S"     "52M 14S"    "52M 17S"   
 [21] "1M 50.3S"   "1M 51.89S"  "1M 52.4S"   "1M 52.55S"  "1M 52.57S" 
 [26] "1M 52.67S"  "1M 52.8S"   "1M 52.83S"  "1M 52.88S"  "1M 52.89S" 
 [31] "4M 57.37S"  "4M 59.22S"  "4M 59.78S"  "5M 0.06S"   "5M 0.21S"  
 [36] "5M 0.47S"   "5M 1.17S"   "5M 1.99S"   "5M 2.16S"   "5M 2.23S"  
 [41] "10M 14.33S" "10M 15.4S"  "10M 22.59S" "10M 22.84S" "10M 24.14S"
 [46] "10M 24.82S" "10M 26.34S" "10M 26.89S" "10M 33.15S" "10M 36.6S" 
 [51] "16M 58.48S" "17M 3.21S"  "17M 6.78S"  "17M 9.09S"  "17M 9.26S" 
 [56] "17M 12.18S" "17M 12.46S" "17M 13.58S" "17M 21.98S" "17M 24.49S"
 [61] "55M 66S"    "55M 67S"    "55M 91S"    "56M 11S"    "56M 74S"   
 [66] "56M 83S"    "57M 18S"    "57M 36S"    "57M 47S"    "57M 56S"   
 [71] "1M 59.91S"  "2M 2.1S"    "2M 3.73S"   "2M 3.85S"   "2M 3.92S"  
 [76] "2M 5.1S"    "2M 5.56S"   "2M 5.71S"   "2M 5.76S"   "2M 6.13S"  
 [81] "1M 1.84S"   "1M 3.28S"   "1M 3.51S"   "1M 3.91S"   "1M 4.16S"  
 [86] "1M 4.19S"   "1M 4.65S"   "1M 4.66S"   "1M 4.77S"   "1M 4.94S"  
 [91] "2M 14.83S"  "2M 15.62S"  "2M 18.99S"  "2M 19.06S"  "2M 19.78S" 
 [96] "2M 20.01S"  "2M 21.17S"  "2M 21.77S"  "2M 22.34S"  "2M 22.83S" 
[101] "54M 76S"    "54M 92S"    "54M 93S"    "55M 23S"    "55M 74S"   
[106] "56M 4S"     "56M 27S"    "56M 42S"    "56M 47S"    "56M 56S"   
[111] "2M 1.84S"   "2M 2.58S"   "2M 3.8S"    "2M 4.05S"   "2M 4.42S"  
[116] "2M 4.81S"   "2M 6.4S"    "2M 7.12S"   "2M 7.33S"   "2M 7.42S"  
[121] "2M 0.69S"   "2M 3.59S"   "2M 3.79S"   "2M 4.74S"   "2M 5.41S"  
[126] "2M 6.82S"   "2M 7.12S"   "2M 7.14S"   "2M 7.81S"   "2M 7.94S"  
[131] "22M 69S"    "22M 92S"    "22M 93S"    "22M 95S"    "23M 27S"   
[136] "23M 31S"    "23M 33S"    "23M 38S"    "23M 45S"    "23M 47S"   
[141] "50M 65S"    "50M 67S"    "50M 92S"    "51M 19S"    "51M 27S"   
[146] "51M 28S"    "51M 29S"    "51M 37S"    "51M 45S"    "51M 56S"   
[151] "1M 50.91S"  "1M 50.98S"  "1M 51.39S"  "1M 51.41S"  "1M 51.56S" 
[156] "1M 51.64S"  "1M 51.95S"  "1M 52.53S"  "1M 52.78S"  "1M 53.04S" 
[161] "4M 15.73S"  "4M 27.18S"  "4M 30.33S"  "4M 30.77S"  "4M 31.96S" 
[166] "4M 32.45S"  "4M 32.57S"  "4M 32.68S"  "4M 34.16S"  "4M 34.27S" 
[171] "25M 94S"    "26M 22S"    "26M 28S"    "26M 57S"    "26M 82S"   
[176] "26M 90S"    "27M 14S"    "27M 14S"    "27M 16S"    "27M 17S"   
[181] "28M 33S"    "28M 96S"    "29M 5S"     "29M 6S"     "29M 9S"    
[186] "29M 9S"     "29M 24S"    "29M 26S"    "29M 46S"    "29M 55S"   
[191] "24M 5S"     "24M 28S"    "24M 58S"    "24M 59S"    "24M 65S"   
[196] "24M 85S"    "25M 5S"     "25M 8S"     "25M 24S"    "25M 34S"   
[201] "54M 65S"    "54M 81S"    "54M 91S"    "55M 11S"    "55M 13S"   
[206] "55M 25S"    "55M 27S"    "55M 45S"    "55M 62S"    "56M 21S"   
[211] "1M 1.1S"    "1M 2.88S"   "1M 2.89S"   "1M 3.67S"   "1M 4.1S"   
[216] "1M 4.16S"   "1M 4.24S"   "1M 4.26S"   "1M 4.35S"   "1M 4.43S"  
[221] "19M 98S"    "20M 21S"    "20M 22S"    "20M 36S"    "20M 51S"   
[226] "20M 65S"    "20M 69S"    "20M 71S"    "20M 79S"    "20M 82S"   
[231] "44M 6S"     "44M 21S"    "44M 73S"    "44M 94S"    "45M 24S"   
[236] "45M 31S"    "45M 32S"    "45M 45S"    "45M 50S"    "45M 50S"   
[241] "1M 38.35S"  "1M 38.88S"  "1M 39.07S"  "1M 39.35S"  "1M 39.63S" 
[246] "1M 39.8S"   "1M 39.82S"  "1M 40.3S"   "1M 40.31S"  "1M 40.5S"  
[251] "4M 25.67S"  "4M 28.11S"  "4M 28.89S"  "4M 29.32S"  "4M 31.64S" 
[256] "4M 32.52S"  "4M 32.65S"  "4M 32.94S"  "4M 32.98S"  "4M 34.7S"  
[261] "9M 14.11S"  "9M 24.43S"  "9M 35.78S"  "9M 36.64S"  "9M 39.27S" 
[266] "9M 40.02S"  "9M 41.48S"  "9M 45.72S"  "9M 46.63S"  "9M 47.09S" 
[271] "15M 17.24S" "15M 32.19S" "15M 45.57S" "15M 47.4S"  "15M 52.94S"
[276] "15M 53.75S" "15M 56.57S" "15M 57.89S" "16M 2.45S"  "16M 3.38S" 
[281] "46M 99S"    "47M 57S"    "49M 32S"    "49M 97S"    "50M 3S"    
[286] "50M 29S"    "50M 35S"    "50M 41S"    "50M 51S"    "50M 59S"   
[291] "1M 45.05S"  "1M 45.67S"  "1M 46.51S"  "1M 48.84S"  "1M 49.01S" 
[296] "1M 49.38S"  "1M 50.32S"  "1M 50.43S"  "1M 51.07S"  "1M 51.57S" 
[301] "54M 88S"    "55M 80S"    "55M 92S"    "56M 3S"     "56M 27S"   
[306] "56M 35S"    "56M 36S"    "56M 45S"    "56M 49S"    "56M 49S"   
[311] "1M 59.9S"   "2M 1.18S"   "2M 1.45S"   "2M 1.6S"    "2M 1.66S"  
[316] "2M 1.77S"   "2M 1.78S"   "2M 2.89S"   "2M 3.19S"   "2M 3.23S"  
[321] "47M 45S"    "47M 56S"    "47M 80S"    "48M 74S"    "48M 91S"   
[326] "49M 26S"    "49M 31S"    "49M 34S"    "49M 68S"    "49M 74S"   
[331] "1M 43.96S"  "1M 48.7S"   "1M 49.24S"  "1M 49.95S"  "1M 49.96S" 
[336] "1M 50.34S"  "1M 50.47S"  "1M 50.49S"  "1M 50.51S"  "1M 50.76S" 
[341] "1M 46.97S"  "1M 48.74S"  "1M 49.74S"  "1M 50.51S"  "1M 50.78S" 
[346] "1M 51.11S"  "1M 51.24S"  "1M 51.48S"  "1M 51.82S"  "1M 51.83S" 
[351] "19M 47S"    "19M 63S"    "19M 96S"    "20M 8S"     "20M 10S"   
[356] "20M 14S"    "20M 18S"    "20M 22S"    "20M 25S"    "20M 28S"   
[361] "43M 28S"    "43M 69S"    "43M 74S"    "44M 43S"    "44M 57S"   
[366] "44M 59S"    "44M 81S"    "44M 81S"    "44M 83S"    "44M 87S"   
[371] "1M 37.98S"  "1M 38.49S"  "1M 39.09S"  "1M 39.19S"  "1M 39.66S" 
[376] "1M 40.21S"  "1M 40.22S"  "1M 40.44S"  "1M 40.7S"   "1M 40.7S"  
[381] "3M 55.61S"  "3M 56.68S"  "3M 56.88S"  "3M 59.02S"  "3M 59.13S" 
[386] "3M 59.17S"  "4M 0.63S"   "4M 1.14S"   "4M 2.38S"   "4M 2.99S"  
[391] "22M 32S"    "22M 50S"    "22M 84S"    "23M 0S"     "23M 24S"   
[396] "23M 45S"    "23M 72S"    "23M 74S"    "23M 85S"    "23M 87S"   
[401] "24M 73S"    "24M 81S"    "24M 88S"    "25M 10S"    "25M 20S"   
[406] "25M 47S"    "25M 55S"    "25M 63S"    "26M 1S"     "26M 5S"    
[411] "20M 60S"    "21M 38S"    "21M 48S"    "21M 58S"    "21M 60S"   
[416] "21M 81S"    "21M 83S"    "22M 0S"     "22M 6S"     "22M 7S"    
[421] "47M 1S"     "47M 72S"    "48M 39S"    "48M 50S"    "48M 54S"   
[426] "48M 82S"    "49M 0S"     "49M 45S"    "49M 52S"    "49M 60S"   
[431] "54M 52S"    "55M 15S"    "55M 21S"    "55M 47S"    "55M 62S"   
[436] "56M 4S"     "56M 13S"    "56M 19S"    "56M 35S"    "56M 48S"   </code></pre>
</div>
</div>
<p>Great! All elements are in the form of <code>"xxM XXs"</code>. But does <strong>{lubridate}</strong> also convert seconds to a numeric value when using <code>period_to_seconds()</code>? If loaded, we can also remove the name of the library when calling the functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(<span class="fu">period_to_seconds</span>(<span class="fu">ms</span>(DAT<span class="sc">$</span>time)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>So let’s go ahead and modify the character vector named <code>time</code> to a numeric vector representing seconds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">period_to_seconds</span>(<span class="fu">ms</span>(DAT<span class="sc">$</span>time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1409.00 1411.00 1429.00 1451.00 1456.00 1457.00 1457.00 1467.00 1473.00
 [10] 1442.00 3065.00 3084.00 3101.00 3116.00 3116.00 3148.00 3125.00 3125.00
 [19] 3134.00 3137.00  110.30  111.89  112.40  112.55  112.57  112.67  112.80
 [28]  112.83  112.88  112.89  297.37  299.22  299.78  300.06  300.21  300.47
 [37]  301.17  301.99  302.16  302.23  614.33  615.40  622.59  622.84  624.14
 [46]  624.82  626.34  626.89  633.15  636.60 1018.48 1023.21 1026.78 1029.09
 [55] 1029.26 1032.18 1032.46 1033.58 1041.98 1044.49 3366.00 3367.00 3391.00
 [64] 3371.00 3434.00 3443.00 3438.00 3456.00 3467.00 3476.00  119.91  122.10
 [73]  123.73  123.85  123.92  125.10  125.56  125.71  125.76  126.13   61.84
 [82]   63.28   63.51   63.91   64.16   64.19   64.65   64.66   64.77   64.94
 [91]  134.83  135.62  138.99  139.06  139.78  140.01  141.17  141.77  142.34
[100]  142.83 3316.00 3332.00 3333.00 3323.00 3374.00 3364.00 3387.00 3402.00
[109] 3407.00 3416.00  121.84  122.58  123.80  124.05  124.42  124.81  126.40
[118]  127.12  127.33  127.42  120.69  123.59  123.79  124.74  125.41  126.82
[127]  127.12  127.14  127.81  127.94 1389.00 1412.00 1413.00 1415.00 1407.00
[136] 1411.00 1413.00 1418.00 1425.00 1427.00 3065.00 3067.00 3092.00 3079.00
[145] 3087.00 3088.00 3089.00 3097.00 3105.00 3116.00  110.91  110.98  111.39
[154]  111.41  111.56  111.64  111.95  112.53  112.78  113.04  255.73  267.18
[163]  270.33  270.77  271.96  272.45  272.57  272.68  274.16  274.27 1594.00
[172] 1582.00 1588.00 1617.00 1642.00 1650.00 1634.00 1634.00 1636.00 1637.00
[181] 1713.00 1776.00 1745.00 1746.00 1749.00 1749.00 1764.00 1766.00 1786.00
[190] 1795.00 1445.00 1468.00 1498.00 1499.00 1505.00 1525.00 1505.00 1508.00
[199] 1524.00 1534.00 3305.00 3321.00 3331.00 3311.00 3313.00 3325.00 3327.00
[208] 3345.00 3362.00 3381.00   61.10   62.88   62.89   63.67   64.10   64.16
[217]   64.24   64.26   64.35   64.43 1238.00 1221.00 1222.00 1236.00 1251.00
[226] 1265.00 1269.00 1271.00 1279.00 1282.00 2646.00 2661.00 2713.00 2734.00
[235] 2724.00 2731.00 2732.00 2745.00 2750.00 2750.00   98.35   98.88   99.07
[244]   99.35   99.63   99.80   99.82  100.30  100.31  100.50  265.67  268.11
[253]  268.89  269.32  271.64  272.52  272.65  272.94  272.98  274.70  554.11
[262]  564.43  575.78  576.64  579.27  580.02  581.48  585.72  586.63  587.09
[271]  917.24  932.19  945.57  947.40  952.94  953.75  956.57  957.89  962.45
[280]  963.38 2859.00 2877.00 2972.00 3037.00 3003.00 3029.00 3035.00 3041.00
[289] 3051.00 3059.00  105.05  105.67  106.51  108.84  109.01  109.38  110.32
[298]  110.43  111.07  111.57 3328.00 3380.00 3392.00 3363.00 3387.00 3395.00
[307] 3396.00 3405.00 3409.00 3409.00  119.90  121.18  121.45  121.60  121.66
[316]  121.77  121.78  122.89  123.19  123.23 2865.00 2876.00 2900.00 2954.00
[325] 2971.00 2966.00 2971.00 2974.00 3008.00 3014.00  103.96  108.70  109.24
[334]  109.95  109.96  110.34  110.47  110.49  110.51  110.76  106.97  108.74
[343]  109.74  110.51  110.78  111.11  111.24  111.48  111.82  111.83 1187.00
[352] 1203.00 1236.00 1208.00 1210.00 1214.00 1218.00 1222.00 1225.00 1228.00
[361] 2608.00 2649.00 2654.00 2683.00 2697.00 2699.00 2721.00 2721.00 2723.00
[370] 2727.00   97.98   98.49   99.09   99.19   99.66  100.21  100.22  100.44
[379]  100.70  100.70  235.61  236.68  236.88  239.02  239.13  239.17  240.63
[388]  241.14  242.38  242.99 1352.00 1370.00 1404.00 1380.00 1404.00 1425.00
[397] 1452.00 1454.00 1465.00 1467.00 1513.00 1521.00 1528.00 1510.00 1520.00
[406] 1547.00 1555.00 1563.00 1561.00 1565.00 1260.00 1298.00 1308.00 1318.00
[415] 1320.00 1341.00 1343.00 1320.00 1326.00 1327.00 2821.00 2892.00 2919.00
[424] 2930.00 2934.00 2962.00 2940.00 2985.00 2992.00 3000.00 3292.00 3315.00
[433] 3321.00 3347.00 3362.00 3364.00 3373.00 3379.00 3395.00 3408.00</code></pre>
</div>
</div>
<p>Perfect! Let’s <code>mutate()</code> that variable in the data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(., <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>   <span class="co"># rows 1 through 5</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">time =</span> <span class="fu">period_to_seconds</span>(<span class="fu">ms</span>(time)))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  time             name year   event   team
1 1409 Jocelyn Crawford 2019 50 FREE Athena
2 1411    Ava Sealander 2022 50 FREE Athena
3 1429        Kelly Ngo 2016 50 FREE Athena
4 1451        Helen Liu 2014 50 FREE Athena
5 1456      Michele Kee 2014 50 FREE Athena</code></pre>
</div>
</div>
<p>Let’s look at <code>DAT</code> now and see those seconds. You can look at the entire data frame if you wish rather than its <code>head()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   time             name year   event   team
1 23.29 Jocelyn Crawford 2019 50 FREE Athena
2 23.31    Ava Sealander 2022 50 FREE Athena
3 23.49        Kelly Ngo 2016 50 FREE Athena
4 23.71        Helen Liu 2014 50 FREE Athena
5 23.76      Michele Kee 2014 50 FREE Athena
6 23.77 Natalia Orbach-M 2020 50 FREE Athena</code></pre>
</div>
</div>
<p>The data frame has not changed. The final step is to assign assign the returned data frame to an object. Remove the <code>slice()</code> so we get the entire data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">time =</span> <span class="fu">period_to_seconds</span>(<span class="fu">ms</span>(time)))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s write this to <code>/data</code>. But we don’t want to overwrite this file. <strong>{here}</strong> won’t be as effective but we can concatenate the <code>file_name</code> string object with a prefix like <code>"cleaned"</code> using the <code>paste()</code> function in <code>base R</code>. We will add a hyphen, <code>-</code>, by passing it to the <code>sep</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"cleaned"</span>, file_name, <span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cleaned-cms-top-all-time-2023-swim.xlsx"</code></pre>
</div>
</div>
<p>When paired with <code>here::here()</code>, does the full file path look right?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="fu">paste</span>(<span class="st">"cleaned"</span>, file_name, <span class="at">sep =</span> <span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/gcook/Sync/git/quarto_course_start/data/cleaned-cms-top-all-time-2023-swim.xlsx"</code></pre>
</div>
</div>
<p>We also want to write a <code>.csv</code> file. Let’s use <code>gsub()</code> to look or the string pattern <code>".xlxs"</code> and replace it with <code>".csv"</code> for the file path string.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>new_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="at">pattern =</span> <span class="st">".xlsx"</span>, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">replacement =</span> <span class="st">".csv"</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="fu">paste</span>(<span class="st">"cleaned"</span>, file_name, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Got our new file name! Let’s write!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_csv</span>(DAT, new_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Done!</p>
</section>
</section>
</section>
<section id="quick-summary-using-base-r" class="level1">
<h1><strong>Quick Summary Using <code>base R</code></strong></h1>
<p>If you want a quick summary of data, <code>summary()</code> will provide some basic information for you. You can pass a data frame to the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(DAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      time            name               year              event          
 Min.   :  61.1   Length:440         Length:440         Length:440        
 1st Qu.: 123.9   Class :character   Class :character   Class :character  
 Median :1115.7   Mode  :character   Mode  :character   Mode  :character  
 Mean   :1309.4                                                           
 3rd Qu.:2721.0                                                           
 Max.   :3476.0                                                           
     team          
 Length:440        
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
</section>
<section id="summarizing-data-using-dplyr" class="level1">
<h1><strong>Summarizing Data Using {dplyr}</strong></h1>
<p>However, there are many ways to summarize data. To introduce data summary techniques using <strong>{dplyr}</strong>, we will open <code>DAT</code> and use <code>dplyr::summarise()</code> or <code>dplyr::summarize()</code> to summarize the data. The <code>summarise()</code> function works similar to <code>mutate()</code> insofar as it creates variables but it differs insofar as the data frame returned from <code>summarise()</code> contains only the variable(s) referenced in as part of that summary process. This includes some function calls immediately prior to <code>summarize()</code>.</p>
<p>In the example below, we summarize by creating a new variable which is set to represent some data summary technique. In essence, summarizing is for descriptive statistics. Using <code>mean()</code>, we can summarize the data by taking the mean of the <code>time</code> variable.</p>
<pre><code>summarize(.data, 
   ..., 
   .by = NULL, 
   .groups = NULL
   )</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(time, <span class="at">na.rm =</span> T),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean
1 1309.388</code></pre>
</div>
</div>
<p>Notice what is returned is a single value reflecting the mean of all the data in the data frame. We could have obtained the same without using <strong>{dplyr}</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(DAT<span class="sc">$</span>time, <span class="at">na.rm =</span> T)        <span class="co"># $ notation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1309.388</code></pre>
</div>
</div>
<p>But we lose flexibility of easily adding new summary procedures. We can summarize by two name-value pair functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(time, <span class="at">na.rm =</span> T),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(time, <span class="at">na.rm =</span> T)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean       sd
1 1309.388 1225.964</code></pre>
</div>
</div>
<p>Now there is a mean and standard deviation for price. You can also add the sample size using <code>dplyr::n()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(time, <span class="at">na.rm =</span> T),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd   =</span> <span class="fu">sd</span>(time, <span class="at">na.rm =</span> T),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n    =</span> <span class="fu">n</span>()</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean       sd   n
1 1309.388 1225.964 440</code></pre>
</div>
</div>
</section>
<section id="summarizing-across-multiple-variables" class="level1">
<h1><strong>Summarizing <code>across()</code> Multiple Variables</strong></h1>
<p>Summarizing a single variable is useful but if you want to summarize by many, you likely do not want to code a new line for each variable. In such cases, you can use <code>across()</code> as a helper function as was used for creating new variables with <code>mutate()</code> (see previous lesson).</p>
<p><code>across()</code> has three main arguments:</p>
<ul>
<li><code>.cols</code>: specifies the columns to summarize across</li>
<li><code>.fns</code>: specifies the function(s) for the summary</li>
<li><code>.names</code>: specifies the output variable names</li>
</ul>
<p>Remember <code>across()</code> will want you to pass the columns to summarize by, <code>.cols</code>, the function for how to summarize, <code>.fns</code>, and the names for how to name the new variables, <code>.names</code> (which will be <code>NULL</code> by default). The <code>.x</code> here stands for passing the vector to the mean function and not the data frame. More on <code>~</code> and <code>.x</code> later.</p>
<section id="summarize-across-by-numeric-variables" class="level2">
<h2 class="anchored" data-anchor-id="summarize-across-by-numeric-variables"><em>Summarize across by numeric variables:</em></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      time
1 1309.388</code></pre>
</div>
</div>
<p>Well, that’s now actually impressive because there is only one numeric variable. What if we had more that were piped to <code>summarize()</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">num1 =</span> time,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">num2 =</span> time,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">num3 =</span> time</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      time     num1     num2     num3
1 1309.388 1309.388 1309.388 1309.388</code></pre>
</div>
</div>
<p>That was easy.</p>
<p>Because <code>across()</code> is so powerful, let’s just add another variable to the data frame for using in examples. You might also wish to reorder the position of variables in the data frame so that they are grouped in some way. We can use <code>dplyr::relocate()</code> to accomplish this. We will move the <code>time</code> column to the position <code>.before</code> one of the new variables using <code>relocate(., time, .before = min)</code>.</p>
<p>Doing so will also show you some ways to create variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sec =</span> time,  <span class="co"># will be redundant with time but named accurately</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">min  =</span> time<span class="sc">/</span><span class="dv">60</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hour =</span> time<span class="sc">/</span>(<span class="dv">60</span><span class="sc">*</span><span class="dv">60</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(., time, <span class="at">.before =</span> sec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take a look:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              name year   event   team time  sec      min      hour
1 Jocelyn Crawford 2019 50 FREE Athena 1409 1409 23.48333 0.3913889
2    Ava Sealander 2022 50 FREE Athena 1411 1411 23.51667 0.3919444
3        Kelly Ngo 2016 50 FREE Athena 1429 1429 23.81667 0.3969444
4        Helen Liu 2014 50 FREE Athena 1451 1451 24.18333 0.4030556
5      Michele Kee 2014 50 FREE Athena 1456 1456 24.26667 0.4044444
6 Natalia Orbach-M 2020 50 FREE Athena 1457 1457 24.28333 0.4047222</code></pre>
</div>
</div>
<p>Variable names created with <code>across()</code> is controlled using the <code>.names</code> argument. The default is equivalent to <code>.names = {.col}</code>, which means that the name(s) are inherited from the <code>.cols</code> argument; the names are a stand-in for the name specification. If you wish to have control over the names, you can pass a string that that either appends (e.g.,<code>"{.col}suffix"</code>) or prepends (e.g.,<code>"prefix{.col}"</code>) a string to each column name. This string looks odd because it’s a special <em>glue</em> specification that glues together with a string with an object. We will use this concept later when using the <strong>{glue}</strong> library.</p>
<p>When modifying <code>.names</code>, include a character like <code>"_"</code> (e.g.,<code>"{.col}_suffix"</code>) so that the column names and the appended text are separated, making the name easily legible. If you summarize to create means, a good suggestion is something like (e.g.,<code>"{.col}_mean"</code> or (e.g.,<code>"{.col}_mn"</code>)) so that you know the variable is a mean. If you prefer the function name first, you can use a prefix (e.g.,<code>"mean_{.col}"</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>, <span class="st">"hour"</span>), </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_mean"</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sec_mean min_mean hour_mean
1 1309.388 21.82313 0.3637189</code></pre>
</div>
</div>
<p>You can see how all variables in the summary end in <code>"_mean"</code>.</p>
<p>You can also glue the function and the column names together by passing <code>.names = "{.col}_{.fn}"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>, <span class="st">"hour"</span>), </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sec_1    min_1    hour_1
1 1309.388 21.82313 0.3637189</code></pre>
</div>
</div>
<p>You you will see there is a number that is appended to the variable name. This is because there is only one function passed to <code>.fns</code>. You can pass more using a special object called a list (see <code>?list</code>). Unlike vectors, elements of lists need not be the same kind. Elements of lists can combinations of characters, numbers, data frames, functions, etc.</p>
</section>
<section id="passing-multiple-functions-from-a-list-in-across" class="level2">
<h2 class="anchored" data-anchor-id="passing-multiple-functions-from-a-list-in-across"><em>Passing multiple functions from a <code>list()</code> in <code>across()</code></em></h2>
<p>Passing functions as a list requires a little fancy coding. We will pass two functions as a <code>list</code> so that we can calculate both the <code>mean()</code> and the <code>sd()</code> on the variables passed to <code>across()</code>.</p>
<p>A <code>list</code> is a special object (e.g., container) for which its elements can be different types of objects. Whereas elements of <code>vectors</code> can be only character or only numeric, elements of lists can hold different object. One element can be a numeric vector, another element a data frame, another element a character vector, etc. Many functions used in R will actually return lists for which elements contain different types of objects.</p>
<p>OK back to two or more functions. If you pass a <code>list()</code> with arguments for the <code>mean</code> and the <code>sd</code> (e.g., <code>list(mean, sd)</code>, you can summarize by both. If you want to prevent errors (yes you do) and want to keep the summaries separate (probably so), you can modify <code>.names</code> to pass both the column and the function (e.g., <code>"{.col}_{.fn}"</code>). The underscore is not needed here; it only helps with readability of the variables so that you don’t end up with variable names like <code>var1mean</code> but instead <code>var1_mean</code>.</p>
<p>Let’s pass the summary procedures as a <code>list</code> to include measures of mean and standard deviation for the variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols  =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>, <span class="st">"hour"</span>), </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns   =</span> <span class="fu">list</span>(mean, sd),</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sec_1    sec_2    min_1    min_2    hour_1    hour_2
1 1309.388 1225.964 21.82313 20.43274 0.3637189 0.3405456</code></pre>
</div>
</div>
<p>Well those are not exactly the names we want but it illustrates how names are created. Because we have two summary functions for each column variable passed to <code>across()</code>, they are enumerated according to the order in the list (e.g., mean then standard deviation).</p>
<section id="fixing-.names-when-passing-lists-to-.cols-in-across" class="level3">
<h3 class="anchored" data-anchor-id="fixing-.names-when-passing-lists-to-.cols-in-across"><em>Fixing <code>.names</code> when passing lists to <code>.cols</code> in <code>across()</code></em></h3>
<p>Enumeration is not helpful for remembering variable names. There are different ways to do fix this problem, some of which may be better under certain scenarios. You have to determine what approach is best but I’ll lay out some limitations. If you pass only the functions into the list, then when you pass <code>{.fn}</code> to <code>.names</code>, the variable names in the returned data frame will take on a numeric value representing the order/element position of the functions as you entered them in the <code>list</code>. In this coding instance, means would be named with<code>"_1"</code> and standard deviation names with <code>"_2"</code>. This approach, however, leads to confusing variable names because you have to remember which is 1 and which is 2 and of course explain this to anyone with whom you share the data. Let’s take a look.</p>
<p>A better approach could be to assign the <code>mean</code> and <code>sd</code> functions their own names in the <code>list()</code> function call. By doing so, the name is appended and the new variable is named meaningfully.</p>
<p>Let’s modify what we pass to <code>.fns</code> by passing a list containing 3 functions (e.g., <code>mean()</code>, <code>sd()</code>, and <code>length()</code>) and give each there name. I know this part is confusing because the <code>()</code> are dropped inside the list. This is just how <code>R</code> works. Don’t blame the messenger.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>, <span class="st">"hour"</span>), </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sd =</span> sd,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n =</span> length</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span>)</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sec_mean   sec_sd sec_n min_mean   min_sd min_n hour_mean   hour_sd hour_n
1 1309.388 1225.964   440 21.82313 20.43274   440 0.3637189 0.3405456    440</code></pre>
</div>
</div>
<p>Importantly, however, certain functions like <code>mean()</code> will operate in ways you might not expect. One one hand, it does what we expect when all elements can be used to calculate the mean.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(DAT<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1309.388</code></pre>
</div>
</div>
<p>On the other hand, if there is a missing value, it does not computer the mean but instead something else. Let’s add an <code>NA</code> to the vector using <code>c()</code> to see what happens.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<section id="understanding-nas-when-passing-lists-to-.cols-in-across" class="level4">
<h4 class="anchored" data-anchor-id="understanding-nas-when-passing-lists-to-.cols-in-across"><em>Understanding <code>NA</code>s when passing lists to <code>.cols</code> in <code>across()</code></em></h4>
<p>The <code>mean()</code> function returns <code>NA</code> rather than a mean. If there is just one <code>NA</code>, <code>mean()</code> returns <code>NA</code>. By design this is actually good.</p>
<p>Let’s also try <code>sd()</code> for the standard deviation of a vector:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>The median of a vector, <code>median()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>The length of a vector, <code>length()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 441</code></pre>
</div>
</div>
<p>Well, that’s interesting. By default <code>length()</code> will return the number of elements of the vector including <code>NA</code>s but by default <code>mean()</code> will not return the mean of a vector with <code>NA</code>s because <code>na.rm = FALSE</code> by default. If you wish to calculate the mean by removing the <code>NA</code>s, pass <code>na.rm = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>), <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1309.388</code></pre>
</div>
</div>
<p>Make note, however, that the length of this vector without <code>NA</code>s is <strong>shorter</strong> than the length with <code>NA</code>s. We can test this hypothesis on a vector with and without the <code>NA</code> by using <code>na.omit()</code> to omit any of them. Using our vector we added an <code>NA</code>, let’s omit it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">na.omit</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1409.00 1411.00 1429.00 1451.00 1456.00 1457.00 1457.00 1467.00 1473.00
 [10] 1442.00 3065.00 3084.00 3101.00 3116.00 3116.00 3148.00 3125.00 3125.00
 [19] 3134.00 3137.00  110.30  111.89  112.40  112.55  112.57  112.67  112.80
 [28]  112.83  112.88  112.89  297.37  299.22  299.78  300.06  300.21  300.47
 [37]  301.17  301.99  302.16  302.23  614.33  615.40  622.59  622.84  624.14
 [46]  624.82  626.34  626.89  633.15  636.60 1018.48 1023.21 1026.78 1029.09
 [55] 1029.26 1032.18 1032.46 1033.58 1041.98 1044.49 3366.00 3367.00 3391.00
 [64] 3371.00 3434.00 3443.00 3438.00 3456.00 3467.00 3476.00  119.91  122.10
 [73]  123.73  123.85  123.92  125.10  125.56  125.71  125.76  126.13   61.84
 [82]   63.28   63.51   63.91   64.16   64.19   64.65   64.66   64.77   64.94
 [91]  134.83  135.62  138.99  139.06  139.78  140.01  141.17  141.77  142.34
[100]  142.83 3316.00 3332.00 3333.00 3323.00 3374.00 3364.00 3387.00 3402.00
[109] 3407.00 3416.00  121.84  122.58  123.80  124.05  124.42  124.81  126.40
[118]  127.12  127.33  127.42  120.69  123.59  123.79  124.74  125.41  126.82
[127]  127.12  127.14  127.81  127.94 1389.00 1412.00 1413.00 1415.00 1407.00
[136] 1411.00 1413.00 1418.00 1425.00 1427.00 3065.00 3067.00 3092.00 3079.00
[145] 3087.00 3088.00 3089.00 3097.00 3105.00 3116.00  110.91  110.98  111.39
[154]  111.41  111.56  111.64  111.95  112.53  112.78  113.04  255.73  267.18
[163]  270.33  270.77  271.96  272.45  272.57  272.68  274.16  274.27 1594.00
[172] 1582.00 1588.00 1617.00 1642.00 1650.00 1634.00 1634.00 1636.00 1637.00
[181] 1713.00 1776.00 1745.00 1746.00 1749.00 1749.00 1764.00 1766.00 1786.00
[190] 1795.00 1445.00 1468.00 1498.00 1499.00 1505.00 1525.00 1505.00 1508.00
[199] 1524.00 1534.00 3305.00 3321.00 3331.00 3311.00 3313.00 3325.00 3327.00
[208] 3345.00 3362.00 3381.00   61.10   62.88   62.89   63.67   64.10   64.16
[217]   64.24   64.26   64.35   64.43 1238.00 1221.00 1222.00 1236.00 1251.00
[226] 1265.00 1269.00 1271.00 1279.00 1282.00 2646.00 2661.00 2713.00 2734.00
[235] 2724.00 2731.00 2732.00 2745.00 2750.00 2750.00   98.35   98.88   99.07
[244]   99.35   99.63   99.80   99.82  100.30  100.31  100.50  265.67  268.11
[253]  268.89  269.32  271.64  272.52  272.65  272.94  272.98  274.70  554.11
[262]  564.43  575.78  576.64  579.27  580.02  581.48  585.72  586.63  587.09
[271]  917.24  932.19  945.57  947.40  952.94  953.75  956.57  957.89  962.45
[280]  963.38 2859.00 2877.00 2972.00 3037.00 3003.00 3029.00 3035.00 3041.00
[289] 3051.00 3059.00  105.05  105.67  106.51  108.84  109.01  109.38  110.32
[298]  110.43  111.07  111.57 3328.00 3380.00 3392.00 3363.00 3387.00 3395.00
[307] 3396.00 3405.00 3409.00 3409.00  119.90  121.18  121.45  121.60  121.66
[316]  121.77  121.78  122.89  123.19  123.23 2865.00 2876.00 2900.00 2954.00
[325] 2971.00 2966.00 2971.00 2974.00 3008.00 3014.00  103.96  108.70  109.24
[334]  109.95  109.96  110.34  110.47  110.49  110.51  110.76  106.97  108.74
[343]  109.74  110.51  110.78  111.11  111.24  111.48  111.82  111.83 1187.00
[352] 1203.00 1236.00 1208.00 1210.00 1214.00 1218.00 1222.00 1225.00 1228.00
[361] 2608.00 2649.00 2654.00 2683.00 2697.00 2699.00 2721.00 2721.00 2723.00
[370] 2727.00   97.98   98.49   99.09   99.19   99.66  100.21  100.22  100.44
[379]  100.70  100.70  235.61  236.68  236.88  239.02  239.13  239.17  240.63
[388]  241.14  242.38  242.99 1352.00 1370.00 1404.00 1380.00 1404.00 1425.00
[397] 1452.00 1454.00 1465.00 1467.00 1513.00 1521.00 1528.00 1510.00 1520.00
[406] 1547.00 1555.00 1563.00 1561.00 1565.00 1260.00 1298.00 1308.00 1318.00
[415] 1320.00 1341.00 1343.00 1320.00 1326.00 1327.00 2821.00 2892.00 2919.00
[424] 2930.00 2934.00 2962.00 2940.00 2985.00 2992.00 3000.00 3292.00 3315.00
[433] 3321.00 3347.00 3362.00 3364.00 3373.00 3379.00 3395.00 3408.00
attr(,"na.action")
[1] 441
attr(,"class")
[1] "omit"</code></pre>
</div>
</div>
<p>And then get the length when <code>NA</code>s are omitted:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">na.omit</span>(<span class="fu">c</span>(DAT<span class="sc">$</span>time, <span class="cn">NA</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 440</code></pre>
</div>
</div>
<p>This behavior is important because if you want to obtain the mean of a variable with <code>NA</code>s and the sample size using <code>length()</code>, your sample size will be inaccurate.</p>
<p>In order to see these operations on a data frame and in the context of <code>dplyr::summarize()</code>, let’s modify the data frame to include an additional row with some mission values. One simple approach is to use <code>base R</code> to use <code>rbind()</code> to bind a new row to the end of the data frame. In this case, the contents of that new row will be the same as the first row of the data frame (e.g., <code>DAT[1,]</code>). Then the name will be changed and some values will be made missing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DAT, </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>             DAT[<span class="dv">1</span>,]</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>             )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Modify the cells in the data frame using bracket notation from <code>base R</code>. When using brackets, the data frame can be referenced using row and column arguments.</p>
<p>Examples:</p>
<pre><code>DAT[]       # all rows and columns

DAT[,]      # all rows and columns (preferred separation with comma)

DAT[1, ]    # row 1, all columns

DAT[,1]     # all rows, column 1

DAT[1:5, "name"]    # rows 1 through 5, "name" column

DAT[, c("name", "year"]    # all rows, "name" and "year" columns

DAT[15, "name"]    # row 15 through 5, "name" column</code></pre>
<p>You can also obtain the dimensions of a data frame using <code>dim()</code> from <code>base R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(DAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 441   8</code></pre>
</div>
</div>
<p><code>dim()</code> returns a vector with two elements: the number of rows and the number of columns. We can use this to reference the last row in the data frame in order to modify it for this example.</p>
<p>Following from above, examine the last row, change the <code>"name"</code> to “Anonymous” and then put <code>NA</code>s in the <code>"sec"</code> and <code>"min"</code> columns for the same row. Remember, vectors are pure characters or numeric, they cannot contain a mixture of them. Because <code>"name"</code> is character vector and <code>"sec"</code> and <code>"min"</code> are numeric vectors, we need to fix them separately. There are other ways to accomplish this goal but this example illustrates the approach in <code>base R</code> so that you have some exposure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>DAT[<span class="fu">dim</span>(DAT)[<span class="dv">1</span>], ]                              <span class="co"># the current row contents</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                name year   event   team time  sec      min      hour
441 Jocelyn Crawford 2019 50 FREE Athena 1409 1409 23.48333 0.3913889</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>DAT[<span class="fu">dim</span>(DAT)[<span class="dv">1</span>], <span class="st">"name"</span>] <span class="ot">&lt;-</span> <span class="st">"Anonymous"</span>         <span class="co"># make name anonymous</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>DAT[<span class="fu">dim</span>(DAT)[<span class="dv">1</span>], <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>)  <span class="co"># set these cells to NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Are <code>NA</code>s across the last row now?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span> <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             name year               event   team time  sec      min      hour
436 Aaron Lutzker 2019 100 BRST-Relay Spl.   Stag 3364 3364 56.06667 0.9344444
437  Sean Hoerger 2020 100 BRST-Relay Spl.   Stag 3373 3373 56.21667 0.9369444
438   Tyler Welty 2017 100 BRST-Relay Spl.   Stag 3379 3379 56.31667 0.9386111
439  Brad Perfect 2013 100 BRST-Relay Spl.   Stag 3395 3395 56.58333 0.9430556
440  Grant Murray 2018 100 BRST-Relay Spl.   Stag 3408 3408 56.80000 0.9466667
441     Anonymous 2019             50 FREE Athena 1409   NA       NA 0.3913889</code></pre>
</div>
</div>
</section>
<section id="comparing-some-functionality-when-passing-lists-to-.cols-in-across" class="level4">
<h4 class="anchored" data-anchor-id="comparing-some-functionality-when-passing-lists-to-.cols-in-across"><em>Comparing some functionality when passing lists to <code>.cols</code> in <code>across()</code></em></h4>
<p>When functions do not contain argument for dealing with <code>NA</code>s, there is <code>na.omit()</code>, a function that takes an object and removes <code>NA</code>s. So you can just pass the variable to <code>na.omit()</code> and then wrap it in the metric function of interest. Also, because <code>na.rm = T</code> cannot be used for <code>length()</code>, <code>na.omit()</code> offers consistency across all functions and as a result, I believe, less confusion.</p>
<p>Unfortunately, accomplishing this task can be rather tricky and requires some new syntax. This requires usage of what’s called a “lambda” technique. You will want to incorporate <code>~</code> and <code>.x</code> into your code. The <code>~</code> is used to indicate that you are supplying a lambda function and use of <code>.x</code> is to indicate where the variable in <code>across()</code> is used. Using this type of syntax, we can pass functions to the <code>.fns</code> argument that operate across a set of variables. The <code>?across()</code> documentation calls this “a <strong>{purrr}</strong>-style lambda” in the arguments section. This approach can be a little bit confusing, so I’m going to show you an example, and then walk through it step by step. You can always create code snippets so you don’t have to rely on memory write complicated code like this.</p>
<p>Anyway, we will precede the function with <code>~</code> and reference the vector using <code>.x</code>. Let’s do this and change the <code>.fns</code> argument slightly.</p>
<p>Here is a general example:</p>
<pre><code>name = ~function(na.omit(.x))</code></pre>
<p>We will summarize only <code>time</code> and <code>sec</code> because those variables are identical except for the row we added. We will also add <code>dplyr::n()</code> to see what’s going on with that function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"sec"</span>), </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="co">#sd = ~sd(na.omit(.x)),</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">len =</span> <span class="sc">~</span><span class="fu">length</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n =</span> <span class="sc">~</span>dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  time_mean time_len time_n sec_mean sec_len sec_n
1  1309.614      441    441 1309.388     440   441</code></pre>
</div>
</div>
<p>So what happened? The means and lengths for <code>time</code> and <code>sec</code> are not the same. Means differ because they are calculated by different values depending on the presence of <code>NA</code>s. But notice that the n’s are the same based on <code>dplyr::n()</code>. How can the means and differ if the n’s are the same?</p>
<p>So what’s the point of all of this? Well, you need to be careful not to apply functions and assume they are doing what you believe you are doing. You always need to be smarter than the code you use. Also, there is no single answer for dealing with data. Sometimes one approach will be appropriate and in other instances another approach will be. You as the data scientist need to know that there are different methods so that you an decide where to apply those different methods.</p>
</section>
</section>
</section>
<section id="summarize-by-groups-using-group_by" class="level2">
<h2 class="anchored" data-anchor-id="summarize-by-groups-using-group_by"><strong>Summarize by Groups Using <code>group_by()</code></strong></h2>
<section id="identifying-how-to-group" class="level3">
<h3 class="anchored" data-anchor-id="identifying-how-to-group"><em>Identifying how to group</em></h3>
<p>When you have subgroups in your data, you will often want to create summary statistics by those group levels. A typical grouping approach is by some categorical or factor variable present in a data frame. Using <code>glympse()</code>, we can view all variables to see what might be of interest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(DAT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 441
Columns: 8
$ name  &lt;chr&gt; "Jocelyn Crawford", "Ava Sealander", "Kelly Ngo", "Helen Liu", "…
$ year  &lt;chr&gt; "2019", "2022", "2016", "2014", "2014", "2020", "2020", "2010", …
$ event &lt;chr&gt; "50 FREE", "50 FREE", "50 FREE", "50 FREE", "50 FREE", "50 FREE"…
$ team  &lt;chr&gt; "Athena", "Athena", "Athena", "Athena", "Athena", "Athena", "Ath…
$ time  &lt;dbl&gt; 1409.00, 1411.00, 1429.00, 1451.00, 1456.00, 1457.00, 1457.00, 1…
$ sec   &lt;dbl&gt; 1409.00, 1411.00, 1429.00, 1451.00, 1456.00, 1457.00, 1457.00, 1…
$ min   &lt;dbl&gt; 23.483333, 23.516667, 23.816667, 24.183333, 24.266667, 24.283333…
$ hour  &lt;dbl&gt; 0.39138889, 0.39194444, 0.39694444, 0.40305556, 0.40444444, 0.40…</code></pre>
</div>
</div>
<p>Looks like some factor variables we can group by include <code>name</code>, <code>year</code>, <code>event</code>, and <code>team</code>.</p>
</section>
</section>
<section id="summarize-a-one-specific-variable-by-groups-using-group_by" class="level2">
<h2 class="anchored" data-anchor-id="summarize-a-one-specific-variable-by-groups-using-group_by"><strong>Summarize A (one) Specific Variable by Groups Using <code>group_by()</code></strong></h2>
<section id="a-single-summary-metric" class="level3">
<h3 class="anchored" data-anchor-id="a-single-summary-metric"><em>A single summary metric</em></h3>
<p>Perhaps you only want to obtain the <code>mean()</code> or the <code>sum()</code> or the <code>sd()</code> for a variable. If so, this is easiest.</p>
<section id="grouping-by-one-variable" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-one-variable"><em>Grouping by one variable</em>:</h4>
<p>The data in cms-top-all-time-2023-swim.xlsx contain the top records for swimming events. You might be curious what <code>year</code> was the best of all time or what swimmer (e.g., <code>name</code>) has attained the most records of all time. There are different ways to accomplish this goal.</p>
<p>One approach that might be the most straight forward to new programmers is to mutate a constant count variable on each row which can be used to sum the counts for different groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">count =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>         <span class="co"># mutate a new variable where all rows get a 1</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., name) <span class="sc">%&gt;%</span>            <span class="co"># group by the swimmer name</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="at">count =</span> <span class="fu">sum</span>(count)) <span class="co"># sum the count and assign it the name count</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 2
   name            count
   &lt;chr&gt;           &lt;dbl&gt;
 1 A Breazeale         8
 2 A Roeseler          2
 3 Aaron Lutzker       6
 4 Abel Sapirstein     1
 5 Alec Vercruysse     4
 6 Alex Mendoza        2
 7 Alex Poltash        6
 8 Allyson Yao         3
 9 Amy Fuller          1
10 Andrew Cox          4
# ℹ 132 more rows</code></pre>
</div>
</div>
<p>By default, the data frame is arranged by the grouping variable (e.g., <code>name</code>). We can change the order of the rows by <code>count</code> using <code>arrange()</code> but this function by default sorts in an ascending manner. If you want a descending sorting, pass <code>count</code> to <code>desc()</code> to arrange the data frame in this way. We can also assign it to an object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>NAME_count <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">count =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., name) <span class="sc">%&gt;%</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="at">count =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(., <span class="fu">desc</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>NAME_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 2
   name          count
   &lt;chr&gt;         &lt;dbl&gt;
 1 Michele Kee      11
 2 Augusta Lewis    10
 3 Matt Williams    10
 4 Kelly Ngo         9
 5 A Breazeale       8
 6 Ava Sealander     8
 7 Gary Simon        8
 8 Marco Conati      8
 9 Nic Tekieli       7
10 Aaron Lutzker     6
# ℹ 132 more rows</code></pre>
</div>
</div>
<p>We can see that the top counts of all time are by Michele Kee for a total of 11. Kudos to Michele!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>YEAR_count <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">count =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., year) <span class="sc">%&gt;%</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="at">count =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(., <span class="fu">desc</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>YEAR_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 2
   year  count
   &lt;chr&gt; &lt;dbl&gt;
 1 2022     81
 2 2023     59
 3 2020     41
 4 2017     38
 5 2014     27
 6 2019     23
 7 2013     22
 8 2015     20
 9 2016     17
10 2018     16
# ℹ 22 more rows</code></pre>
</div>
</div>
<p>We can see that the year with the most best are by 2022 for a total of 81. Hooray for 2022!</p>
</section>
<section id="grouping-by-two-or-more-variables" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-two-or-more-variables"><em>Grouping by two or more variables</em>:</h4>
<p>We can also summarize both the teams as well in order to see the top swimmer by team. If you want to summarize more than one variable, pass them both in <code>group_by()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>TEAM_NAME_count <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">count =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., team, name) <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="at">count =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(., <span class="fu">desc</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'team'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>TEAM_NAME_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 3
# Groups:   team [2]
   team   name          count
   &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;
 1 Athena Michele Kee      11
 2 Athena Augusta Lewis    10
 3 Stag   Matt Williams    10
 4 Athena Kelly Ngo         9
 5 Athena Ava Sealander     8
 6 Stag   A Breazeale       8
 7 Stag   Gary Simon        8
 8 Stag   Marco Conati      8
 9 Stag   Nic Tekieli       7
10 Athena Ella Blake        6
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section id="filtering-rows-and-then-grouping-by-one-variable" class="level4">
<h4 class="anchored" data-anchor-id="filtering-rows-and-then-grouping-by-one-variable"><em>Filtering rows and then grouping by one variable</em>:</h4>
<p>For Athenas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>ATHENA_NAME_count <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">count =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(., team <span class="sc">==</span> <span class="st">"Athena"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., name) <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="at">count =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(., <span class="fu">desc</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>ATHENA_NAME_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 67 × 2
   name               count
   &lt;chr&gt;              &lt;dbl&gt;
 1 Michele Kee           11
 2 Augusta Lewis         10
 3 Kelly Ngo              9
 4 Ava Sealander          8
 5 Ella Blake             6
 6 Jamee Mitchum          6
 7 Katie Bilotti          6
 8 Mackenzie Mayfield     6
 9 Annika Jessen          5
10 Jocelyn Crawford       5
# ℹ 57 more rows</code></pre>
</div>
</div>
<p>We can see that the top counts of all time are by Michele Kee with a total of 11. Nice work Michele!</p>
<p>And for Stags:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>STAG_NAME_count <span class="ot">&lt;-</span> DAT <span class="sc">%&gt;%</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(., <span class="at">count =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(., team <span class="sc">==</span> <span class="st">"Stag"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., name) <span class="sc">%&gt;%</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="at">count =</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(., <span class="fu">desc</span>(count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>STAG_NAME_count</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 2
   name          count
   &lt;chr&gt;         &lt;dbl&gt;
 1 Matt Williams    10
 2 A Breazeale       8
 3 Gary Simon        8
 4 Marco Conati      8
 5 Nic Tekieli       7
 6 Aaron Lutzker     6
 7 Alex Poltash      6
 8 Blake Weber       6
 9 Sam Willett       5
10 Tom Harrison      5
# ℹ 65 more rows</code></pre>
</div>
</div>
<p>We can see that the top counts of all time are by Matt Williams with 10. Go Matt!</p>
<p>To wrap up this example, sometimes working with separate data frames using <code>filter()</code> can provide more useful or manageable summaries.Perhaps you only want to obtain the <code>mean()</code> or the <code>sum()</code> or the <code>sd()</code> for a single variable. If so, this approach may be easiest.</p>
<p>If you are curious, here is a story covering <a href="https://www.cmc.edu/magazine/fall-2016/how-cms-teams-became-stags-and-athenas">“How CMS teams became the Stags and Athenas”</a>.</p>
</section>
</section>
<section id="multiple-summary-metrics" class="level3">
<h3 class="anchored" data-anchor-id="multiple-summary-metrics"><em>Multiple summary metrics</em></h3>
<p>Sometimes you need more than one summary statistic, for example, the <code>mean()</code> and the <code>sd()</code>. This is a little more complex to code.</p>
<p><em>Note:</em> In these code blocks, some arguments may be removed for readability.</p>
<section id="grouping-by-one-variable-1" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-one-variable-1"><em>Grouping by one variable</em>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event) <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sec_mean =</span> <span class="fu">mean</span>(sec, <span class="at">na.rm =</span> T),  </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sec_median =</span> <span class="fu">median</span>(sec, <span class="at">na.rm =</span> T)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 3
   event               sec_mean sec_median
   &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
 1 100 BACK               3209.      3212.
 2 100 BREAST             1725.      1696.
 3 100 BRST-Relay Spl.    1710.      1678.
 4 100 FLY                3158.      3165 
 5 100 FLY-Relay Spl.     3135.      3152.
 6 100 FREE               2917.      2908.
 7 100 FREE-Relay Spl.    2888.      2896 
 8 1000 FREE               601.       601.
 9 1650 FREE               990.       991.
10 200 BACK                116.       116.
# ℹ 12 more rows</code></pre>
</div>
</div>
<p>We can also write the summary functions as a list inside <code>across()</code> along with passing <code>.names = "{.col}_{.fn}"</code> if you want the variables named automatically. This approach is more complex but is more flexible.</p>
<p>When you want to summarize across multiple variables using a list of functions, you will want to make sure your <code>.fns</code> argument passes a function using a <strong>{purrr}</strong>-style lambda (e.g.,<code>~</code>) for that the function is applied across the variables. You will also want to edit <code>.names = "{.col}_{.fn}"</code> so that the naming is done automatically rather than hard coding the names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="st">"sec"</span>,</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 3
   event               sec_mean sec_median
   &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;
 1 100 BACK               3209.      3212.
 2 100 BREAST             1725.      1696.
 3 100 BRST-Relay Spl.    1710.      1678.
 4 100 FLY                3158.      3165 
 5 100 FLY-Relay Spl.     3135.      3152.
 6 100 FREE               2917.      2908.
 7 100 FREE-Relay Spl.    2888.      2896 
 8 1000 FREE               601.       601.
 9 1650 FREE               990.       991.
10 200 BACK                116.       116.
# ℹ 12 more rows</code></pre>
</div>
</div>
</section>
<section id="grouping-by-two-or-more-variables-1" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-two-or-more-variables-1"><em>Grouping by two or more variables</em>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event, team) <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sec_mean =</span> <span class="fu">mean</span>(sec, <span class="at">na.rm =</span> T),  </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sec_median =</span> <span class="fu">median</span>(sec, <span class="at">na.rm =</span> T)</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'event'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
# Groups:   event [22]
   event               team   sec_mean sec_median
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 100 BACK            Athena   3421.      3436  
 2 100 BACK            Stag     2996.      3032  
 3 100 BREAST          Athena     64.0       64.2
 4 100 BREAST          Stag     3386.      3394. 
 5 100 BRST-Relay Spl. Athena     63.6       64.1
 6 100 BRST-Relay Spl. Stag     3356.      3363  
 7 100 FLY             Athena   3365.      3369  
 8 100 FLY             Stag     2950.      2968. 
 9 100 FLY-Relay Spl.  Athena   3332.      3326  
10 100 FLY-Relay Spl.  Stag     2938.      2937  
# ℹ 34 more rows</code></pre>
</div>
</div>
<p>Or pass the list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event, team) <span class="sc">%&gt;%</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="st">"sec"</span>,</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'event'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
# Groups:   event [22]
   event               team   sec_mean sec_median
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1 100 BACK            Athena   3421.      3436  
 2 100 BACK            Stag     2996.      3032  
 3 100 BREAST          Athena     64.0       64.2
 4 100 BREAST          Stag     3386.      3394. 
 5 100 BRST-Relay Spl. Athena     63.6       64.1
 6 100 BRST-Relay Spl. Stag     3356.      3363  
 7 100 FLY             Athena   3365.      3369  
 8 100 FLY             Stag     2950.      2968. 
 9 100 FLY-Relay Spl.  Athena   3332.      3326  
10 100 FLY-Relay Spl.  Stag     2938.      2937  
# ℹ 34 more rows</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="summarizing-multiple-variables-by-groups-using-group_by" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-multiple-variables-by-groups-using-group_by"><strong>Summarizing Multiple Variables by Groups Using <code>group_by()</code></strong></h2>
<p>So far, we have shown how to summarize a single variable either with or without grouping by levels of another variable. Summaries, however, are often done for multiple variables in data frame. For example, you might want to obtain the <code>mean()</code> for multiple variables or obtain the <code>mean()</code> and the <code>max()</code> (or some other summary statistic) for multiple variables. The following examples prepare you for such tasks.</p>
<section id="a-single-summary-metric-1" class="level3">
<h3 class="anchored" data-anchor-id="a-single-summary-metric-1"><em>A single summary metric</em></h3>
<section id="grouping-by-one-variable-2" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-one-variable-2"><em>Grouping by one variable</em>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event) <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>),</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T),</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 3
   event               sec_1 min_1
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;
 1 100 BACK            3209. 53.5 
 2 100 BREAST          1725. 28.8 
 3 100 BRST-Relay Spl. 1710. 28.5 
 4 100 FLY             3158. 52.6 
 5 100 FLY-Relay Spl.  3135. 52.2 
 6 100 FREE            2917. 48.6 
 7 100 FREE-Relay Spl. 2888. 48.1 
 8 1000 FREE            601. 10.0 
 9 1650 FREE            990. 16.5 
10 200 BACK             116.  1.94
# ℹ 12 more rows</code></pre>
</div>
</div>
</section>
<section id="grouping-by-two-or-more-variables-2" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-two-or-more-variables-2"><em>Grouping by two or more variables</em>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event, team) <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>),</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> T),</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'event'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
# Groups:   event [22]
   event               team    sec_1 min_1
   &lt;chr&gt;               &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 100 BACK            Athena 3421.  57.0 
 2 100 BACK            Stag   2996.  49.9 
 3 100 BREAST          Athena   64.0  1.07
 4 100 BREAST          Stag   3386.  56.4 
 5 100 BRST-Relay Spl. Athena   63.6  1.06
 6 100 BRST-Relay Spl. Stag   3356.  55.9 
 7 100 FLY             Athena 3365.  56.1 
 8 100 FLY             Stag   2950.  49.2 
 9 100 FLY-Relay Spl.  Athena 3332.  55.5 
10 100 FLY-Relay Spl.  Stag   2938.  49.0 
# ℹ 34 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-summary-metrics-1" class="level3">
<h3 class="anchored" data-anchor-id="multiple-summary-metrics-1"><em>Multiple summary metrics</em></h3>
<p>And if you need to summarize using multiple metrics, then pass the list into <code>.fns</code>:</p>
<section id="grouping-by-one-variable-3" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-one-variable-3"><em>Grouping by one variable</em>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event) <span class="sc">%&gt;%</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>),</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 5
   event               sec_mean sec_median min_mean min_median
   &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 100 BACK               3209.      3212.    53.5       53.5 
 2 100 BREAST             1725.      1696.    28.8       28.3 
 3 100 BRST-Relay Spl.    1710.      1678.    28.5       28.0 
 4 100 FLY                3158.      3165     52.6       52.8 
 5 100 FLY-Relay Spl.     3135.      3152.    52.2       52.5 
 6 100 FREE               2917.      2908.    48.6       48.5 
 7 100 FREE-Relay Spl.    2888.      2896     48.1       48.3 
 8 1000 FREE               601.       601.    10.0       10.0 
 9 1650 FREE               990.       991.    16.5       16.5 
10 200 BACK                116.       116.     1.94       1.93
# ℹ 12 more rows</code></pre>
</div>
</div>
</section>
<section id="grouping-by-two-or-more-variables-3" class="level4">
<h4 class="anchored" data-anchor-id="grouping-by-two-or-more-variables-3"><em>Grouping by two or more variables</em>:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., event, team) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">c</span>(<span class="st">"sec"</span>, <span class="st">"min"</span>),</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'event'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 6
# Groups:   event [22]
   event               team   sec_mean sec_median min_mean min_median
   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 100 BACK            Athena   3421.      3436      57.0       57.3 
 2 100 BACK            Stag     2996.      3032      49.9       50.5 
 3 100 BREAST          Athena     64.0       64.2     1.07       1.07
 4 100 BREAST          Stag     3386.      3394.     56.4       56.6 
 5 100 BRST-Relay Spl. Athena     63.6       64.1     1.06       1.07
 6 100 BRST-Relay Spl. Stag     3356.      3363      55.9       56.0 
 7 100 FLY             Athena   3365.      3369      56.1       56.2 
 8 100 FLY             Stag     2950.      2968.     49.2       49.5 
 9 100 FLY-Relay Spl.  Athena   3332.      3326      55.5       55.4 
10 100 FLY-Relay Spl.  Stag     2938.      2937      49.0       49.0 
# ℹ 34 more rows</code></pre>
</div>
</div>
<p>Depends on the order in <code>group_by()</code>, so change the order:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., team, event) <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="st">"sec"</span>,</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n =</span> <span class="sc">~</span><span class="fu">length</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'team'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
# Groups:   team [2]
   team   event               sec_mean sec_n
   &lt;chr&gt;  &lt;chr&gt;                  &lt;dbl&gt; &lt;int&gt;
 1 Athena 100 BACK              3421.     10
 2 Athena 100 BREAST              64.0    10
 3 Athena 100 BRST-Relay Spl.     63.6    10
 4 Athena 100 FLY               3365.     10
 5 Athena 100 FLY-Relay Spl.    3332.     10
 6 Athena 100 FREE              3115.     10
 7 Athena 100 FREE-Relay Spl.   3088.     10
 8 Athena 1000 FREE              625.     10
 9 Athena 1650 FREE             1031.     10
10 Athena 200 BACK               124.     10
# ℹ 34 more rows</code></pre>
</div>
</div>
<p>Notice the change in the order of the column variables. But remember, you can change the order later using <code>select()</code> and/or <code>relocate()</code>.</p>
</section>
</section>
</section>
<section id="summarizing-multiple-variables-with-reference-by-name" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-multiple-variables-with-reference-by-name"><strong>Summarizing Multiple Variables With Reference by Name`</strong></h2>
<section id="variables-that-are-numeric" class="level3">
<h3 class="anchored" data-anchor-id="variables-that-are-numeric"><em>Variables that are numeric</em></h3>
<p>You can also pass variables that are a certain type, like numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., team, event) <span class="sc">%&gt;%</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">where</span>(is.numeric), </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}"</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'team'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 6
# Groups:   team [2]
   team   event                 time    sec   min   hour
   &lt;chr&gt;  &lt;chr&gt;                &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Athena 100 BACK            3421.  3421.  57.0  0.950 
 2 Athena 100 BREAST            64.0   64.0  1.07 0.0178
 3 Athena 100 BRST-Relay Spl.   63.6   63.6  1.06 0.0177
 4 Athena 100 FLY             3365.  3365.  56.1  0.935 
 5 Athena 100 FLY-Relay Spl.  3332.  3332.  55.5  0.926 
 6 Athena 100 FREE            3115.  3115.  51.9  0.865 
 7 Athena 100 FREE-Relay Spl. 3088.  3088.  51.5  0.858 
 8 Athena 1000 FREE            625.   625.  10.4  0.174 
 9 Athena 1650 FREE           1031.  1031.  17.2  0.286 
10 Athena 200 BACK             124.   124.   2.07 0.0345
# ℹ 34 more rows</code></pre>
</div>
</div>
</section>
<section id="variables-by-pattern-match" class="level3">
<h3 class="anchored" data-anchor-id="variables-by-pattern-match"><em>Variables by pattern match</em></h3>
<p>This approach is fun, especially if you have already named variables in ways that make selection really useful. This data frame is constrained a bit so the examples may be silly.</p>
<section id="using-starts_with" class="level4">
<h4 class="anchored" data-anchor-id="using-starts_with"><em>Using starts_with()</em></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., team, event) <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">starts_with</span>(<span class="st">"t"</span>),</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n =</span> <span class="sc">~</span><span class="fu">length</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'team'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 4
# Groups:   team [2]
   team   event               time_mean time_n
   &lt;chr&gt;  &lt;chr&gt;                   &lt;dbl&gt;  &lt;int&gt;
 1 Athena 100 BACK               3421.      10
 2 Athena 100 BREAST               64.0     10
 3 Athena 100 BRST-Relay Spl.      63.6     10
 4 Athena 100 FLY                3365.      10
 5 Athena 100 FLY-Relay Spl.     3332.      10
 6 Athena 100 FREE               3115.      10
 7 Athena 100 FREE-Relay Spl.    3088.      10
 8 Athena 1000 FREE               625.      10
 9 Athena 1650 FREE              1031.      10
10 Athena 200 BACK                124.      10
# ℹ 34 more rows</code></pre>
</div>
</div>
</section>
<section id="using-for-complex-selection" class="level4">
<h4 class="anchored" data-anchor-id="using-for-complex-selection"><em>Using <code>&amp;</code> for complex selection</em></h4>
<p>You obviously cannot calculate numeric metrics for character variables. But how might you select variables that contain a certain character pattern but are also numeric? You cannot nest these functions (e.g., <code>where(is.numeric(contains("pattern")))</code>). You can, however, pass the functions separately.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>DAT <span class="sc">%&gt;%</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(., team, event) <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> <span class="fu">contains</span>(<span class="st">"e"</span>) <span class="sc">&amp;</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.fns  =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(<span class="fu">na.omit</span>(.x)),</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">n =</span> <span class="sc">~</span><span class="fu">length</span>(<span class="fu">na.omit</span>(.x))</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>                                   ),</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.names =</span> <span class="st">"{.col}_{.fn}"</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>            ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'team'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 6
# Groups:   team [2]
   team   event               time_mean time_n sec_mean sec_n
   &lt;chr&gt;  &lt;chr&gt;                   &lt;dbl&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;int&gt;
 1 Athena 100 BACK               3421.      10   3421.     10
 2 Athena 100 BREAST               64.0     10     64.0    10
 3 Athena 100 BRST-Relay Spl.      63.6     10     63.6    10
 4 Athena 100 FLY                3365.      10   3365.     10
 5 Athena 100 FLY-Relay Spl.     3332.      10   3332.     10
 6 Athena 100 FREE               3115.      10   3115.     10
 7 Athena 100 FREE-Relay Spl.    3088.      10   3088.     10
 8 Athena 1000 FREE               625.      10    625.     10
 9 Athena 1650 FREE              1031.      10   1031.     10
10 Athena 200 BACK                124.      10    124.     10
# ℹ 34 more rows</code></pre>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="summary" class="level1">
<h1><strong>Summary</strong></h1>
<p>You can see that summarizing data can be fun, interesting, simple, but sometimes complex. The examples above are only limited to selecting variables by name. Of course, you can <code>summarize()</code> <code>across()</code> variables that <code>contain()</code> characters or that <code>starts_with()</code> some characters or even across variables that <code>is.numeric()</code> (pardon the grammar) by pairing these functions with the</p>
<section id="a-functional-approach" class="level2">
<h2 class="anchored" data-anchor-id="a-functional-approach"><strong>A Functional Approach</strong></h2>
<p>You can also throw your summaries into functions if you wish. We will create a new object that is a function object. We need to give it a name and we need to define arguments to make the function operate. We will want to make sure we have numeric variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>summarizer <span class="ot">&lt;-</span> <span class="cf">function</span>(data, </span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">cols =</span> <span class="cn">NULL</span>, </span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>                       ...</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>                       ) {</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(...) <span class="sc">%&gt;%</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(., <span class="fu">across</span>(<span class="at">.cols =</span> {{cols}} <span class="sc">&amp;</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">.fns =</span> <span class="fu">list</span>(</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sd   =</span> <span class="sc">~</span><span class="fu">sd</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>                          ), </span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">.names =</span> <span class="st">"{col}_{fn}"</span>)</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Test the function:</p>
<p>Without grouping:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarizer</span>(DAT, <span class="at">cols =</span> <span class="fu">contains</span>(<span class="st">"e"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  time_mean time_sd sec_mean sec_sd
      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1     1310.   1225.    1309.  1226.</code></pre>
</div>
</div>
<p>With grouping:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarizer</span>(DAT, <span class="at">cols =</span> <span class="fu">c</span>(min, hour), event)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 5
   event               min_mean min_sd hour_mean hour_sd
   &lt;chr&gt;                  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 100 BACK               53.5   3.76     0.891  0.0626 
 2 100 BREAST             28.8  28.4      0.479  0.473  
 3 100 BRST-Relay Spl.    28.5  28.1      0.475  0.469  
 4 100 FLY                52.6   3.63     0.877  0.0605 
 5 100 FLY-Relay Spl.     52.2   3.44     0.871  0.0573 
 6 100 FREE               48.6   3.43     0.810  0.0571 
 7 100 FREE-Relay Spl.    48.1   3.46     0.802  0.0576 
 8 1000 FREE              10.0   0.432    0.167  0.00719
 9 1650 FREE              16.5   0.728    0.275  0.0121 
10 200 BACK                1.94  0.136    0.0324 0.00227
# ℹ 12 more rows</code></pre>
</div>
</div>
<p>And of course, when you really get excited, you could add functions so that you can perform different metrics. When you are done, you can save your favorite function to a file you can <code>source()</code>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>